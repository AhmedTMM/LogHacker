"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/audit/[flightId]/route";
exports.ids = ["app/api/audit/[flightId]/route"];
exports.modules = {

/***/ "mongoose":
/*!***************************!*\
  !*** external "mongoose" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("mongoose");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "async_hooks":
/*!******************************!*\
  !*** external "async_hooks" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("async_hooks");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "prettier/plugins/html":
/*!****************************************!*\
  !*** external "prettier/plugins/html" ***!
  \****************************************/
/***/ ((module) => {

module.exports = import("prettier/plugins/html");;

/***/ }),

/***/ "prettier/standalone":
/*!**************************************!*\
  !*** external "prettier/standalone" ***!
  \**************************************/
/***/ ((module) => {

module.exports = import("prettier/standalone");;

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Faudit%2F%5BflightId%5D%2Froute&page=%2Fapi%2Faudit%2F%5BflightId%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Faudit%2F%5BflightId%5D%2Froute.ts&appDir=%2FUsers%2Fahmed%2FDocuments%2FGitHub%2FLogHacker%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fahmed%2FDocuments%2FGitHub%2FLogHacker&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Faudit%2F%5BflightId%5D%2Froute&page=%2Fapi%2Faudit%2F%5BflightId%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Faudit%2F%5BflightId%5D%2Froute.ts&appDir=%2FUsers%2Fahmed%2FDocuments%2FGitHub%2FLogHacker%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fahmed%2FDocuments%2FGitHub%2FLogHacker&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_ahmed_Documents_GitHub_LogHacker_app_api_audit_flightId_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/audit/[flightId]/route.ts */ \"(rsc)/./app/api/audit/[flightId]/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/audit/[flightId]/route\",\n        pathname: \"/api/audit/[flightId]\",\n        filename: \"route\",\n        bundlePath: \"app/api/audit/[flightId]/route\"\n    },\n    resolvedPagePath: \"/Users/ahmed/Documents/GitHub/LogHacker/app/api/audit/[flightId]/route.ts\",\n    nextConfigOutput,\n    userland: _Users_ahmed_Documents_GitHub_LogHacker_app_api_audit_flightId_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/audit/[flightId]/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhdWRpdCUyRiU1QmZsaWdodElkJTVEJTJGcm91dGUmcGFnZT0lMkZhcGklMkZhdWRpdCUyRiU1QmZsaWdodElkJTVEJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGYXVkaXQlMkYlNUJmbGlnaHRJZCU1RCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmFobWVkJTJGRG9jdW1lbnRzJTJGR2l0SHViJTJGTG9nSGFja2VyJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRmFobWVkJTJGRG9jdW1lbnRzJTJGR2l0SHViJTJGTG9nSGFja2VyJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUN5QjtBQUN0RztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL2F2aWF0aW9uLWludGVsbGlnZW5jZS1icmFpbi8/YmI1YiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvYWhtZWQvRG9jdW1lbnRzL0dpdEh1Yi9Mb2dIYWNrZXIvYXBwL2FwaS9hdWRpdC9bZmxpZ2h0SWRdL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hdWRpdC9bZmxpZ2h0SWRdL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYXVkaXQvW2ZsaWdodElkXVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvYXVkaXQvW2ZsaWdodElkXS9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy9haG1lZC9Eb2N1bWVudHMvR2l0SHViL0xvZ0hhY2tlci9hcHAvYXBpL2F1ZGl0L1tmbGlnaHRJZF0vcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2F1ZGl0L1tmbGlnaHRJZF0vcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Faudit%2F%5BflightId%5D%2Froute&page=%2Fapi%2Faudit%2F%5BflightId%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Faudit%2F%5BflightId%5D%2Froute.ts&appDir=%2FUsers%2Fahmed%2FDocuments%2FGitHub%2FLogHacker%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fahmed%2FDocuments%2FGitHub%2FLogHacker&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/audit/[flightId]/route.ts":
/*!*******************************************!*\
  !*** ./app/api/audit/[flightId]/route.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   dynamic: () => (/* binding */ dynamic)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n/* harmony import */ var _lib_models_Flight__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/models/Flight */ \"(rsc)/./lib/models/Flight.ts\");\n/* harmony import */ var _lib_services_legalityService__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/services/legalityService */ \"(rsc)/./lib/services/legalityService.ts\");\n/* harmony import */ var _lib_services_emailService__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/services/emailService */ \"(rsc)/./lib/services/emailService.ts\");\n\n\n\n\n\nconst dynamic = \"force-dynamic\";\nasync function POST(request, { params }) {\n    try {\n        await (0,_lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"])();\n        const { flightId } = params;\n        // Run the legality audit (this updates the flight document)\n        const result = await (0,_lib_services_legalityService__WEBPACK_IMPORTED_MODULE_3__.runLegalityAudit)(flightId);\n        // If no-go, send email alert\n        if (result.overallStatus === \"no-go\") {\n            const flight = await _lib_models_Flight__WEBPACK_IMPORTED_MODULE_2__[\"default\"].findById(flightId).populate(\"pilot\").populate(\"aircraft\").exec();\n            if (flight && !flight.emailSent) {\n                try {\n                    await (0,_lib_services_emailService__WEBPACK_IMPORTED_MODULE_4__.sendAuditEmail)(flight);\n                    flight.emailSent = true;\n                    await flight.save();\n                } catch (emailErr) {\n                    console.warn(\"Email send failed:\", emailErr);\n                }\n            }\n        }\n        // Return populated flight\n        const populatedFlight = await _lib_models_Flight__WEBPACK_IMPORTED_MODULE_2__[\"default\"].findById(flightId).populate(\"pilot\").populate(\"aircraft\");\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            data: populatedFlight,\n            audit: result\n        });\n    } catch (error) {\n        console.error(\"Audit error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: error.message\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2F1ZGl0L1tmbGlnaHRJZF0vcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUF3RDtBQUN2QjtBQUNRO0FBQ3lCO0FBQ0w7QUFFdEQsTUFBTUssVUFBVSxnQkFBZ0I7QUFFaEMsZUFBZUMsS0FDcEJDLE9BQW9CLEVBQ3BCLEVBQUVDLE1BQU0sRUFBb0M7SUFFNUMsSUFBSTtRQUNGLE1BQU1QLG1EQUFTQTtRQUNmLE1BQU0sRUFBRVEsUUFBUSxFQUFFLEdBQUdEO1FBRXJCLDREQUE0RDtRQUM1RCxNQUFNRSxTQUFTLE1BQU1QLCtFQUFnQkEsQ0FBQ007UUFFdEMsNkJBQTZCO1FBQzdCLElBQUlDLE9BQU9DLGFBQWEsS0FBSyxTQUFTO1lBQ3BDLE1BQU1DLFNBQVMsTUFBTVYsMERBQU1BLENBQUNXLFFBQVEsQ0FBQ0osVUFDbENLLFFBQVEsQ0FBQyxTQUNUQSxRQUFRLENBQUMsWUFDVEMsSUFBSTtZQUNQLElBQUlILFVBQVUsQ0FBQ0EsT0FBT0ksU0FBUyxFQUFFO2dCQUMvQixJQUFJO29CQUNGLE1BQU1aLDBFQUFjQSxDQUFDUTtvQkFDckJBLE9BQU9JLFNBQVMsR0FBRztvQkFDbkIsTUFBTUosT0FBT0ssSUFBSTtnQkFDbkIsRUFBRSxPQUFPQyxVQUFVO29CQUNqQkMsUUFBUUMsSUFBSSxDQUFDLHNCQUFzQkY7Z0JBQ3JDO1lBQ0Y7UUFDRjtRQUVBLDBCQUEwQjtRQUMxQixNQUFNRyxrQkFBa0IsTUFBTW5CLDBEQUFNQSxDQUFDVyxRQUFRLENBQUNKLFVBQzNDSyxRQUFRLENBQUMsU0FDVEEsUUFBUSxDQUFDO1FBRVosT0FBT2QscURBQVlBLENBQUNzQixJQUFJLENBQUM7WUFDdkJDLFNBQVM7WUFDVEMsTUFBTUg7WUFDTkksT0FBT2Y7UUFDVDtJQUNGLEVBQUUsT0FBT2dCLE9BQU87UUFDZFAsUUFBUU8sS0FBSyxDQUFDLGdCQUFnQkE7UUFDOUIsT0FBTzFCLHFEQUFZQSxDQUFDc0IsSUFBSSxDQUN0QjtZQUFFQyxTQUFTO1lBQU9HLE9BQU8sTUFBaUJDLE9BQU87UUFBQyxHQUNsRDtZQUFFQyxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2F2aWF0aW9uLWludGVsbGlnZW5jZS1icmFpbi8uL2FwcC9hcGkvYXVkaXQvW2ZsaWdodElkXS9yb3V0ZS50cz9jZDllIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgZGJDb25uZWN0IGZyb20gJ0AvbGliL2RiJztcbmltcG9ydCBGbGlnaHQgZnJvbSAnQC9saWIvbW9kZWxzL0ZsaWdodCc7XG5pbXBvcnQgeyBydW5MZWdhbGl0eUF1ZGl0IH0gZnJvbSAnQC9saWIvc2VydmljZXMvbGVnYWxpdHlTZXJ2aWNlJztcbmltcG9ydCB7IHNlbmRBdWRpdEVtYWlsIH0gZnJvbSAnQC9saWIvc2VydmljZXMvZW1haWxTZXJ2aWNlJztcblxuZXhwb3J0IGNvbnN0IGR5bmFtaWMgPSAnZm9yY2UtZHluYW1pYyc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKFxuICByZXF1ZXN0OiBOZXh0UmVxdWVzdCxcbiAgeyBwYXJhbXMgfTogeyBwYXJhbXM6IHsgZmxpZ2h0SWQ6IHN0cmluZyB9IH1cbikge1xuICB0cnkge1xuICAgIGF3YWl0IGRiQ29ubmVjdCgpO1xuICAgIGNvbnN0IHsgZmxpZ2h0SWQgfSA9IHBhcmFtcztcblxuICAgIC8vIFJ1biB0aGUgbGVnYWxpdHkgYXVkaXQgKHRoaXMgdXBkYXRlcyB0aGUgZmxpZ2h0IGRvY3VtZW50KVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJ1bkxlZ2FsaXR5QXVkaXQoZmxpZ2h0SWQpO1xuXG4gICAgLy8gSWYgbm8tZ28sIHNlbmQgZW1haWwgYWxlcnRcbiAgICBpZiAocmVzdWx0Lm92ZXJhbGxTdGF0dXMgPT09ICduby1nbycpIHtcbiAgICAgIGNvbnN0IGZsaWdodCA9IGF3YWl0IEZsaWdodC5maW5kQnlJZChmbGlnaHRJZClcbiAgICAgICAgLnBvcHVsYXRlKCdwaWxvdCcpXG4gICAgICAgIC5wb3B1bGF0ZSgnYWlyY3JhZnQnKVxuICAgICAgICAuZXhlYygpO1xuICAgICAgaWYgKGZsaWdodCAmJiAhZmxpZ2h0LmVtYWlsU2VudCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IHNlbmRBdWRpdEVtYWlsKGZsaWdodCk7XG4gICAgICAgICAgZmxpZ2h0LmVtYWlsU2VudCA9IHRydWU7XG4gICAgICAgICAgYXdhaXQgZmxpZ2h0LnNhdmUoKTtcbiAgICAgICAgfSBjYXRjaCAoZW1haWxFcnIpIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oJ0VtYWlsIHNlbmQgZmFpbGVkOicsIGVtYWlsRXJyKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFJldHVybiBwb3B1bGF0ZWQgZmxpZ2h0XG4gICAgY29uc3QgcG9wdWxhdGVkRmxpZ2h0ID0gYXdhaXQgRmxpZ2h0LmZpbmRCeUlkKGZsaWdodElkKVxuICAgICAgLnBvcHVsYXRlKCdwaWxvdCcpXG4gICAgICAucG9wdWxhdGUoJ2FpcmNyYWZ0Jyk7XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGRhdGE6IHBvcHVsYXRlZEZsaWdodCxcbiAgICAgIGF1ZGl0OiByZXN1bHQsXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignQXVkaXQgZXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJkYkNvbm5lY3QiLCJGbGlnaHQiLCJydW5MZWdhbGl0eUF1ZGl0Iiwic2VuZEF1ZGl0RW1haWwiLCJkeW5hbWljIiwiUE9TVCIsInJlcXVlc3QiLCJwYXJhbXMiLCJmbGlnaHRJZCIsInJlc3VsdCIsIm92ZXJhbGxTdGF0dXMiLCJmbGlnaHQiLCJmaW5kQnlJZCIsInBvcHVsYXRlIiwiZXhlYyIsImVtYWlsU2VudCIsInNhdmUiLCJlbWFpbEVyciIsImNvbnNvbGUiLCJ3YXJuIiwicG9wdWxhdGVkRmxpZ2h0IiwianNvbiIsInN1Y2Nlc3MiLCJkYXRhIiwiYXVkaXQiLCJlcnJvciIsIm1lc3NhZ2UiLCJzdGF0dXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/audit/[flightId]/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db.ts":
/*!*******************!*\
  !*** ./lib/db.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst MONGODB_URI = process.env.MONGODB_URI || \"mongodb://localhost:27017/aviation-intelligence\";\nif (!MONGODB_URI) {\n    throw new Error(\"Please define the MONGODB_URI environment variable\");\n}\nlet cached = global.mongoose || {\n    conn: null,\n    promise: null\n};\nif (!global.mongoose) {\n    global.mongoose = cached;\n}\nasync function dbConnect() {\n    if (cached.conn) {\n        return cached.conn;\n    }\n    if (!cached.promise) {\n        const opts = {\n            bufferCommands: false,\n            serverSelectionTimeoutMS: 5000,\n            connectTimeoutMS: 5000\n        };\n        cached.promise = mongoose__WEBPACK_IMPORTED_MODULE_0___default().connect(MONGODB_URI, opts).then((mongoose)=>{\n            console.log(\"MongoDB connected successfully\");\n            return mongoose;\n        });\n    }\n    try {\n        cached.conn = await cached.promise;\n    } catch (e) {\n        cached.promise = null;\n        console.error(\"MongoDB connection error:\", e);\n        throw new Error(\"Failed to connect to MongoDB. Please ensure MongoDB is running.\");\n    }\n    return cached.conn;\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (dbConnect);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQWdDO0FBRWhDLE1BQU1DLGNBQWNDLFFBQVFDLEdBQUcsQ0FBQ0YsV0FBVyxJQUFJO0FBRS9DLElBQUksQ0FBQ0EsYUFBYTtJQUNoQixNQUFNLElBQUlHLE1BQU07QUFDbEI7QUFXQSxJQUFJQyxTQUF3QkMsT0FBT04sUUFBUSxJQUFJO0lBQUVPLE1BQU07SUFBTUMsU0FBUztBQUFLO0FBRTNFLElBQUksQ0FBQ0YsT0FBT04sUUFBUSxFQUFFO0lBQ3BCTSxPQUFPTixRQUFRLEdBQUdLO0FBQ3BCO0FBRUEsZUFBZUk7SUFDYixJQUFJSixPQUFPRSxJQUFJLEVBQUU7UUFDZixPQUFPRixPQUFPRSxJQUFJO0lBQ3BCO0lBRUEsSUFBSSxDQUFDRixPQUFPRyxPQUFPLEVBQUU7UUFDbkIsTUFBTUUsT0FBTztZQUNYQyxnQkFBZ0I7WUFDaEJDLDBCQUEwQjtZQUMxQkMsa0JBQWtCO1FBQ3BCO1FBRUFSLE9BQU9HLE9BQU8sR0FBR1IsdURBQWdCLENBQUNDLGFBQWFTLE1BQU1LLElBQUksQ0FBQyxDQUFDZjtZQUN6RGdCLFFBQVFDLEdBQUcsQ0FBQztZQUNaLE9BQU9qQjtRQUNUO0lBQ0Y7SUFFQSxJQUFJO1FBQ0ZLLE9BQU9FLElBQUksR0FBRyxNQUFNRixPQUFPRyxPQUFPO0lBQ3BDLEVBQUUsT0FBT1UsR0FBRztRQUNWYixPQUFPRyxPQUFPLEdBQUc7UUFDakJRLFFBQVFHLEtBQUssQ0FBQyw2QkFBNkJEO1FBQzNDLE1BQU0sSUFBSWQsTUFBTTtJQUNsQjtJQUVBLE9BQU9DLE9BQU9FLElBQUk7QUFDcEI7QUFFQSxpRUFBZUUsU0FBU0EsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2F2aWF0aW9uLWludGVsbGlnZW5jZS1icmFpbi8uL2xpYi9kYi50cz8xZGYwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tICdtb25nb29zZSc7XG5cbmNvbnN0IE1PTkdPREJfVVJJID0gcHJvY2Vzcy5lbnYuTU9OR09EQl9VUkkgfHwgJ21vbmdvZGI6Ly9sb2NhbGhvc3Q6MjcwMTcvYXZpYXRpb24taW50ZWxsaWdlbmNlJztcblxuaWYgKCFNT05HT0RCX1VSSSkge1xuICB0aHJvdyBuZXcgRXJyb3IoJ1BsZWFzZSBkZWZpbmUgdGhlIE1PTkdPREJfVVJJIGVudmlyb25tZW50IHZhcmlhYmxlJyk7XG59XG5cbmludGVyZmFjZSBNb25nb29zZUNhY2hlIHtcbiAgY29ubjogdHlwZW9mIG1vbmdvb3NlIHwgbnVsbDtcbiAgcHJvbWlzZTogUHJvbWlzZTx0eXBlb2YgbW9uZ29vc2U+IHwgbnVsbDtcbn1cblxuZGVjbGFyZSBnbG9iYWwge1xuICB2YXIgbW9uZ29vc2U6IE1vbmdvb3NlQ2FjaGUgfCB1bmRlZmluZWQ7XG59XG5cbmxldCBjYWNoZWQ6IE1vbmdvb3NlQ2FjaGUgPSBnbG9iYWwubW9uZ29vc2UgfHwgeyBjb25uOiBudWxsLCBwcm9taXNlOiBudWxsIH07XG5cbmlmICghZ2xvYmFsLm1vbmdvb3NlKSB7XG4gIGdsb2JhbC5tb25nb29zZSA9IGNhY2hlZDtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZGJDb25uZWN0KCk6IFByb21pc2U8dHlwZW9mIG1vbmdvb3NlPiB7XG4gIGlmIChjYWNoZWQuY29ubikge1xuICAgIHJldHVybiBjYWNoZWQuY29ubjtcbiAgfVxuXG4gIGlmICghY2FjaGVkLnByb21pc2UpIHtcbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgYnVmZmVyQ29tbWFuZHM6IGZhbHNlLFxuICAgICAgc2VydmVyU2VsZWN0aW9uVGltZW91dE1TOiA1MDAwLFxuICAgICAgY29ubmVjdFRpbWVvdXRNUzogNTAwMCxcbiAgICB9O1xuXG4gICAgY2FjaGVkLnByb21pc2UgPSBtb25nb29zZS5jb25uZWN0KE1PTkdPREJfVVJJLCBvcHRzKS50aGVuKChtb25nb29zZSkgPT4ge1xuICAgICAgY29uc29sZS5sb2coJ01vbmdvREIgY29ubmVjdGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgcmV0dXJuIG1vbmdvb3NlO1xuICAgIH0pO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjYWNoZWQuY29ubiA9IGF3YWl0IGNhY2hlZC5wcm9taXNlO1xuICB9IGNhdGNoIChlKSB7XG4gICAgY2FjaGVkLnByb21pc2UgPSBudWxsO1xuICAgIGNvbnNvbGUuZXJyb3IoJ01vbmdvREIgY29ubmVjdGlvbiBlcnJvcjonLCBlKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBjb25uZWN0IHRvIE1vbmdvREIuIFBsZWFzZSBlbnN1cmUgTW9uZ29EQiBpcyBydW5uaW5nLicpO1xuICB9XG5cbiAgcmV0dXJuIGNhY2hlZC5jb25uO1xufVxuXG5leHBvcnQgZGVmYXVsdCBkYkNvbm5lY3Q7XG4iXSwibmFtZXMiOlsibW9uZ29vc2UiLCJNT05HT0RCX1VSSSIsInByb2Nlc3MiLCJlbnYiLCJFcnJvciIsImNhY2hlZCIsImdsb2JhbCIsImNvbm4iLCJwcm9taXNlIiwiZGJDb25uZWN0Iiwib3B0cyIsImJ1ZmZlckNvbW1hbmRzIiwic2VydmVyU2VsZWN0aW9uVGltZW91dE1TIiwiY29ubmVjdFRpbWVvdXRNUyIsImNvbm5lY3QiLCJ0aGVuIiwiY29uc29sZSIsImxvZyIsImUiLCJlcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/db.ts\n");

/***/ }),

/***/ "(rsc)/./lib/models/Flight.ts":
/*!******************************!*\
  !*** ./lib/models/Flight.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst LegalityCheckSchema = new mongoose__WEBPACK_IMPORTED_MODULE_0__.Schema({\n    category: {\n        type: String,\n        enum: [\n            \"maintenance\",\n            \"compliance\",\n            \"safety\",\n            \"pilot\"\n        ],\n        required: true\n    },\n    item: {\n        type: String,\n        required: true\n    },\n    status: {\n        type: String,\n        enum: [\n            \"pass\",\n            \"warning\",\n            \"fail\"\n        ],\n        required: true\n    },\n    message: {\n        type: String,\n        required: true\n    },\n    details: {\n        type: String\n    }\n});\nconst WeatherDataSchema = new mongoose__WEBPACK_IMPORTED_MODULE_0__.Schema({\n    station: {\n        type: String,\n        required: true\n    },\n    metar: {\n        type: String,\n        required: true\n    },\n    taf: {\n        type: String\n    },\n    flightCategory: {\n        type: String,\n        enum: [\n            \"VFR\",\n            \"MVFR\",\n            \"IFR\",\n            \"LIFR\"\n        ],\n        required: true\n    },\n    visibility: {\n        type: Number,\n        required: true\n    },\n    ceiling: {\n        type: Number\n    },\n    wind: {\n        direction: {\n            type: Number,\n            required: true\n        },\n        speed: {\n            type: Number,\n            required: true\n        },\n        gust: {\n            type: Number\n        }\n    },\n    fetchedAt: {\n        type: Date,\n        required: true\n    }\n});\nconst FlightSchema = new mongoose__WEBPACK_IMPORTED_MODULE_0__.Schema({\n    pilot: {\n        type: mongoose__WEBPACK_IMPORTED_MODULE_0__.Schema.Types.ObjectId,\n        ref: \"Pilot\",\n        required: true\n    },\n    aircraft: {\n        type: mongoose__WEBPACK_IMPORTED_MODULE_0__.Schema.Types.ObjectId,\n        ref: \"Aircraft\",\n        required: true\n    },\n    scheduledDate: {\n        type: Date,\n        required: true\n    },\n    scheduledTime: {\n        type: Date\n    },\n    safetyAnalysisSnapshot: {\n        type: mongoose__WEBPACK_IMPORTED_MODULE_0__.Schema.Types.Mixed\n    },\n    departureAirport: {\n        type: String,\n        required: true,\n        uppercase: true,\n        trim: true\n    },\n    arrivalAirport: {\n        type: String,\n        uppercase: true,\n        trim: true\n    },\n    status: {\n        type: String,\n        enum: [\n            \"planned\",\n            \"go\",\n            \"caution\",\n            \"no-go\",\n            \"completed\",\n            \"cancelled\"\n        ],\n        default: \"planned\"\n    },\n    legalityChecks: [\n        LegalityCheckSchema\n    ],\n    overallStatus: {\n        type: String,\n        enum: [\n            \"go\",\n            \"caution\",\n            \"no-go\"\n        ],\n        default: \"no-go\"\n    },\n    weather: WeatherDataSchema,\n    notes: {\n        type: String\n    },\n    emailSent: {\n        type: Boolean,\n        default: false\n    }\n}, {\n    timestamps: true\n});\nconst Flight = (mongoose__WEBPACK_IMPORTED_MODULE_0___default().models).Flight || mongoose__WEBPACK_IMPORTED_MODULE_0___default().model(\"Flight\", FlightSchema);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Flight);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvbW9kZWxzL0ZsaWdodC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBMEQ7QUE4QzFELE1BQU1FLHNCQUFzQixJQUFJRCw0Q0FBTUEsQ0FBaUI7SUFDckRFLFVBQVU7UUFDUkMsTUFBTUM7UUFDTkMsTUFBTTtZQUFDO1lBQWU7WUFBYztZQUFVO1NBQVE7UUFDdERDLFVBQVU7SUFDWjtJQUNBQyxNQUFNO1FBQUVKLE1BQU1DO1FBQVFFLFVBQVU7SUFBSztJQUNyQ0UsUUFBUTtRQUNOTCxNQUFNQztRQUNOQyxNQUFNO1lBQUM7WUFBUTtZQUFXO1NBQU87UUFDakNDLFVBQVU7SUFDWjtJQUNBRyxTQUFTO1FBQUVOLE1BQU1DO1FBQVFFLFVBQVU7SUFBSztJQUN4Q0ksU0FBUztRQUFFUCxNQUFNQztJQUFPO0FBQzFCO0FBRUEsTUFBTU8sb0JBQW9CLElBQUlYLDRDQUFNQSxDQUFlO0lBQ2pEWSxTQUFTO1FBQUVULE1BQU1DO1FBQVFFLFVBQVU7SUFBSztJQUN4Q08sT0FBTztRQUFFVixNQUFNQztRQUFRRSxVQUFVO0lBQUs7SUFDdENRLEtBQUs7UUFBRVgsTUFBTUM7SUFBTztJQUNwQlcsZ0JBQWdCO1FBQ2RaLE1BQU1DO1FBQ05DLE1BQU07WUFBQztZQUFPO1lBQVE7WUFBTztTQUFPO1FBQ3BDQyxVQUFVO0lBQ1o7SUFDQVUsWUFBWTtRQUFFYixNQUFNYztRQUFRWCxVQUFVO0lBQUs7SUFDM0NZLFNBQVM7UUFBRWYsTUFBTWM7SUFBTztJQUN4QkUsTUFBTTtRQUNKQyxXQUFXO1lBQUVqQixNQUFNYztZQUFRWCxVQUFVO1FBQUs7UUFDMUNlLE9BQU87WUFBRWxCLE1BQU1jO1lBQVFYLFVBQVU7UUFBSztRQUN0Q2dCLE1BQU07WUFBRW5CLE1BQU1jO1FBQU87SUFDdkI7SUFDQU0sV0FBVztRQUFFcEIsTUFBTXFCO1FBQU1sQixVQUFVO0lBQUs7QUFDMUM7QUFFQSxNQUFNbUIsZUFBZSxJQUFJekIsNENBQU1BLENBQzdCO0lBQ0UwQixPQUFPO1FBQ0x2QixNQUFNSCw0Q0FBTUEsQ0FBQzJCLEtBQUssQ0FBQ0MsUUFBUTtRQUMzQkMsS0FBSztRQUNMdkIsVUFBVTtJQUNaO0lBQ0F3QixVQUFVO1FBQ1IzQixNQUFNSCw0Q0FBTUEsQ0FBQzJCLEtBQUssQ0FBQ0MsUUFBUTtRQUMzQkMsS0FBSztRQUNMdkIsVUFBVTtJQUNaO0lBQ0F5QixlQUFlO1FBQ2I1QixNQUFNcUI7UUFDTmxCLFVBQVU7SUFDWjtJQUNBMEIsZUFBZTtRQUNiN0IsTUFBTXFCO0lBQ1I7SUFDQVMsd0JBQXdCO1FBQ3RCOUIsTUFBTUgsNENBQU1BLENBQUMyQixLQUFLLENBQUNPLEtBQUs7SUFDMUI7SUFDQUMsa0JBQWtCO1FBQ2hCaEMsTUFBTUM7UUFDTkUsVUFBVTtRQUNWOEIsV0FBVztRQUNYQyxNQUFNO0lBQ1I7SUFDQUMsZ0JBQWdCO1FBQ2RuQyxNQUFNQztRQUNOZ0MsV0FBVztRQUNYQyxNQUFNO0lBQ1I7SUFDQTdCLFFBQVE7UUFDTkwsTUFBTUM7UUFDTkMsTUFBTTtZQUFDO1lBQVc7WUFBTTtZQUFXO1lBQVM7WUFBYTtTQUFZO1FBQ3JFa0MsU0FBUztJQUNYO0lBQ0FDLGdCQUFnQjtRQUFDdkM7S0FBb0I7SUFDckN3QyxlQUFlO1FBQ2J0QyxNQUFNQztRQUNOQyxNQUFNO1lBQUM7WUFBTTtZQUFXO1NBQVE7UUFDaENrQyxTQUFTO0lBQ1g7SUFDQUcsU0FBUy9CO0lBQ1RnQyxPQUFPO1FBQUV4QyxNQUFNQztJQUFPO0lBQ3RCd0MsV0FBVztRQUNUekMsTUFBTTBDO1FBQ05OLFNBQVM7SUFDWDtBQUNGLEdBQ0E7SUFDRU8sWUFBWTtBQUNkO0FBR0YsTUFBTUMsU0FBeUJoRCx3REFBZSxDQUFDZ0QsTUFBTSxJQUFJaEQscURBQWMsQ0FBVSxVQUFVMEI7QUFFM0YsaUVBQWVzQixNQUFNQSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXZpYXRpb24taW50ZWxsaWdlbmNlLWJyYWluLy4vbGliL21vZGVscy9GbGlnaHQudHM/YjBlNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UsIHsgU2NoZW1hLCBNb2RlbCwgVHlwZXMgfSBmcm9tICdtb25nb29zZSc7XG5cbmV4cG9ydCB0eXBlIEZsaWdodFN0YXR1cyA9ICdwbGFubmVkJyB8ICdnbycgfCAnY2F1dGlvbicgfCAnbm8tZ28nIHwgJ2NvbXBsZXRlZCcgfCAnY2FuY2VsbGVkJztcblxuZXhwb3J0IGludGVyZmFjZSBJTGVnYWxpdHlDaGVjayB7XG4gIGNhdGVnb3J5OiAnbWFpbnRlbmFuY2UnIHwgJ2NvbXBsaWFuY2UnIHwgJ3NhZmV0eScgfCAncGlsb3QnO1xuICBpdGVtOiBzdHJpbmc7XG4gIHN0YXR1czogJ3Bhc3MnIHwgJ3dhcm5pbmcnIHwgJ2ZhaWwnO1xuICBtZXNzYWdlOiBzdHJpbmc7XG4gIGRldGFpbHM/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVdlYXRoZXJEYXRhIHtcbiAgc3RhdGlvbjogc3RyaW5nO1xuICBtZXRhcjogc3RyaW5nO1xuICB0YWY/OiBzdHJpbmc7XG4gIGZsaWdodENhdGVnb3J5OiAnVkZSJyB8ICdNVkZSJyB8ICdJRlInIHwgJ0xJRlInO1xuICB2aXNpYmlsaXR5OiBudW1iZXI7XG4gIGNlaWxpbmc/OiBudW1iZXI7XG4gIHdpbmQ6IHtcbiAgICBkaXJlY3Rpb246IG51bWJlcjtcbiAgICBzcGVlZDogbnVtYmVyO1xuICAgIGd1c3Q/OiBudW1iZXI7XG4gIH07XG4gIGZldGNoZWRBdDogRGF0ZTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJRmxpZ2h0IHtcbiAgX2lkOiBtb25nb29zZS5UeXBlcy5PYmplY3RJZDtcbiAgcGlsb3Q6IFR5cGVzLk9iamVjdElkO1xuICBhaXJjcmFmdDogVHlwZXMuT2JqZWN0SWQ7XG4gIHNjaGVkdWxlZERhdGU6IERhdGU7XG4gIHNjaGVkdWxlZFRpbWU/OiBEYXRlOyAvLyBTZXBhcmF0ZSB0aW1lIGlmIG5lZWRlZCwgdGhvdWdoIHNjaGVkdWxlZERhdGUgdXN1YWxseSBjb3ZlcnMgaXRcbiAgZGVwYXJ0dXJlQWlycG9ydDogc3RyaW5nO1xuICBhcnJpdmFsQWlycG9ydD86IHN0cmluZztcbiAgc3RhdHVzOiBGbGlnaHRTdGF0dXM7XG4gIGxlZ2FsaXR5Q2hlY2tzOiBJTGVnYWxpdHlDaGVja1tdO1xuICBvdmVyYWxsU3RhdHVzOiAnZ28nIHwgJ2NhdXRpb24nIHwgJ25vLWdvJztcbiAgd2VhdGhlcj86IElXZWF0aGVyRGF0YTtcbiAgc2FmZXR5QW5hbHlzaXNTbmFwc2hvdD86IGFueTsgLy8gU25hcHNob3Qgb2YgdGhlIHJpc2sgYW5hbHlzaXMgYXQgdGltZSBvZiBjcmVhdGlvbi9hdWRpdFxuICBub3Rlcz86IHN0cmluZztcbiAgZW1haWxTZW50OiBib29sZWFuO1xuICBjcmVhdGVkQXQ6IERhdGU7XG4gIHVwZGF0ZWRBdDogRGF0ZTtcbn1cblxuY29uc3QgTGVnYWxpdHlDaGVja1NjaGVtYSA9IG5ldyBTY2hlbWE8SUxlZ2FsaXR5Q2hlY2s+KHtcbiAgY2F0ZWdvcnk6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZW51bTogWydtYWludGVuYW5jZScsICdjb21wbGlhbmNlJywgJ3NhZmV0eScsICdwaWxvdCddLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICB9LFxuICBpdGVtOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUgfSxcbiAgc3RhdHVzOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGVudW06IFsncGFzcycsICd3YXJuaW5nJywgJ2ZhaWwnXSxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgbWVzc2FnZTogeyB0eXBlOiBTdHJpbmcsIHJlcXVpcmVkOiB0cnVlIH0sXG4gIGRldGFpbHM6IHsgdHlwZTogU3RyaW5nIH0sXG59KTtcblxuY29uc3QgV2VhdGhlckRhdGFTY2hlbWEgPSBuZXcgU2NoZW1hPElXZWF0aGVyRGF0YT4oe1xuICBzdGF0aW9uOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUgfSxcbiAgbWV0YXI6IHsgdHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZSB9LFxuICB0YWY6IHsgdHlwZTogU3RyaW5nIH0sXG4gIGZsaWdodENhdGVnb3J5OiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGVudW06IFsnVkZSJywgJ01WRlInLCAnSUZSJywgJ0xJRlInXSxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgdmlzaWJpbGl0eTogeyB0eXBlOiBOdW1iZXIsIHJlcXVpcmVkOiB0cnVlIH0sXG4gIGNlaWxpbmc6IHsgdHlwZTogTnVtYmVyIH0sXG4gIHdpbmQ6IHtcbiAgICBkaXJlY3Rpb246IHsgdHlwZTogTnVtYmVyLCByZXF1aXJlZDogdHJ1ZSB9LFxuICAgIHNwZWVkOiB7IHR5cGU6IE51bWJlciwgcmVxdWlyZWQ6IHRydWUgfSxcbiAgICBndXN0OiB7IHR5cGU6IE51bWJlciB9LFxuICB9LFxuICBmZXRjaGVkQXQ6IHsgdHlwZTogRGF0ZSwgcmVxdWlyZWQ6IHRydWUgfSxcbn0pO1xuXG5jb25zdCBGbGlnaHRTY2hlbWEgPSBuZXcgU2NoZW1hPElGbGlnaHQ+KFxuICB7XG4gICAgcGlsb3Q6IHtcbiAgICAgIHR5cGU6IFNjaGVtYS5UeXBlcy5PYmplY3RJZCxcbiAgICAgIHJlZjogJ1BpbG90JyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgYWlyY3JhZnQ6IHtcbiAgICAgIHR5cGU6IFNjaGVtYS5UeXBlcy5PYmplY3RJZCxcbiAgICAgIHJlZjogJ0FpcmNyYWZ0JyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgc2NoZWR1bGVkRGF0ZToge1xuICAgICAgdHlwZTogRGF0ZSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgc2NoZWR1bGVkVGltZToge1xuICAgICAgdHlwZTogRGF0ZSxcbiAgICB9LFxuICAgIHNhZmV0eUFuYWx5c2lzU25hcHNob3Q6IHtcbiAgICAgIHR5cGU6IFNjaGVtYS5UeXBlcy5NaXhlZCxcbiAgICB9LFxuICAgIGRlcGFydHVyZUFpcnBvcnQ6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgdXBwZXJjYXNlOiB0cnVlLFxuICAgICAgdHJpbTogdHJ1ZSxcbiAgICB9LFxuICAgIGFycml2YWxBaXJwb3J0OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICB1cHBlcmNhc2U6IHRydWUsXG4gICAgICB0cmltOiB0cnVlLFxuICAgIH0sXG4gICAgc3RhdHVzOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBlbnVtOiBbJ3BsYW5uZWQnLCAnZ28nLCAnY2F1dGlvbicsICduby1nbycsICdjb21wbGV0ZWQnLCAnY2FuY2VsbGVkJ10sXG4gICAgICBkZWZhdWx0OiAncGxhbm5lZCcsXG4gICAgfSxcbiAgICBsZWdhbGl0eUNoZWNrczogW0xlZ2FsaXR5Q2hlY2tTY2hlbWFdLFxuICAgIG92ZXJhbGxTdGF0dXM6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGVudW06IFsnZ28nLCAnY2F1dGlvbicsICduby1nbyddLFxuICAgICAgZGVmYXVsdDogJ25vLWdvJyxcbiAgICB9LFxuICAgIHdlYXRoZXI6IFdlYXRoZXJEYXRhU2NoZW1hLFxuICAgIG5vdGVzOiB7IHR5cGU6IFN0cmluZyB9LFxuICAgIGVtYWlsU2VudDoge1xuICAgICAgdHlwZTogQm9vbGVhbixcbiAgICAgIGRlZmF1bHQ6IGZhbHNlLFxuICAgIH0sXG4gIH0sXG4gIHtcbiAgICB0aW1lc3RhbXBzOiB0cnVlLFxuICB9XG4pO1xuXG5jb25zdCBGbGlnaHQ6IE1vZGVsPElGbGlnaHQ+ID0gbW9uZ29vc2UubW9kZWxzLkZsaWdodCB8fCBtb25nb29zZS5tb2RlbDxJRmxpZ2h0PignRmxpZ2h0JywgRmxpZ2h0U2NoZW1hKTtcblxuZXhwb3J0IGRlZmF1bHQgRmxpZ2h0O1xuIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwiU2NoZW1hIiwiTGVnYWxpdHlDaGVja1NjaGVtYSIsImNhdGVnb3J5IiwidHlwZSIsIlN0cmluZyIsImVudW0iLCJyZXF1aXJlZCIsIml0ZW0iLCJzdGF0dXMiLCJtZXNzYWdlIiwiZGV0YWlscyIsIldlYXRoZXJEYXRhU2NoZW1hIiwic3RhdGlvbiIsIm1ldGFyIiwidGFmIiwiZmxpZ2h0Q2F0ZWdvcnkiLCJ2aXNpYmlsaXR5IiwiTnVtYmVyIiwiY2VpbGluZyIsIndpbmQiLCJkaXJlY3Rpb24iLCJzcGVlZCIsImd1c3QiLCJmZXRjaGVkQXQiLCJEYXRlIiwiRmxpZ2h0U2NoZW1hIiwicGlsb3QiLCJUeXBlcyIsIk9iamVjdElkIiwicmVmIiwiYWlyY3JhZnQiLCJzY2hlZHVsZWREYXRlIiwic2NoZWR1bGVkVGltZSIsInNhZmV0eUFuYWx5c2lzU25hcHNob3QiLCJNaXhlZCIsImRlcGFydHVyZUFpcnBvcnQiLCJ1cHBlcmNhc2UiLCJ0cmltIiwiYXJyaXZhbEFpcnBvcnQiLCJkZWZhdWx0IiwibGVnYWxpdHlDaGVja3MiLCJvdmVyYWxsU3RhdHVzIiwid2VhdGhlciIsIm5vdGVzIiwiZW1haWxTZW50IiwiQm9vbGVhbiIsInRpbWVzdGFtcHMiLCJGbGlnaHQiLCJtb2RlbHMiLCJtb2RlbCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/models/Flight.ts\n");

/***/ }),

/***/ "(rsc)/./lib/services/emailService.ts":
/*!**************************************!*\
  !*** ./lib/services/emailService.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   generateAuditHTML: () => (/* binding */ generateAuditHTML),\n/* harmony export */   sendAuditEmail: () => (/* binding */ sendAuditEmail),\n/* harmony export */   sendThreatAlert: () => (/* binding */ sendThreatAlert)\n/* harmony export */ });\n/* harmony import */ var resend__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! resend */ \"(rsc)/./node_modules/resend/dist/index.mjs\");\n\nconst resend = process.env.RESEND_API_KEY ? new resend__WEBPACK_IMPORTED_MODULE_0__.Resend(process.env.RESEND_API_KEY) : null;\nasync function sendAuditEmail(flight) {\n    if (!resend) {\n        console.warn(\"Resend API key not configured - email not sent\");\n        return {\n            success: false,\n            message: \"Email service not configured\"\n        };\n    }\n    const pilot = flight.pilot;\n    const aircraft = flight.aircraft;\n    if (!pilot?.email) {\n        return {\n            success: false,\n            message: \"Pilot email not found\"\n        };\n    }\n    const statusEmoji = flight.overallStatus === \"go\" ? \"✅\" : flight.overallStatus === \"caution\" ? \"⚠️\" : \"❌\";\n    const statusText = flight.overallStatus === \"go\" ? \"GO - Flight Approved\" : flight.overallStatus === \"caution\" ? \"CAUTION - Review Required\" : \"NO-GO - Flight Not Recommended\";\n    // Build check summary\n    const checkSummary = flight.legalityChecks.map((check)=>{\n        const icon = check.status === \"pass\" ? \"✅\" : check.status === \"warning\" ? \"⚠️\" : \"❌\";\n        return `${icon} ${check.item}: ${check.message}`;\n    }).join(\"\\n\");\n    // Weather summary\n    const weatherSummary = flight.weather ? `\nWeather at ${flight.weather.station}:\n- Conditions: ${flight.weather.flightCategory}\n- Visibility: ${flight.weather.visibility} SM\n- Wind: ${flight.weather.wind.direction}° at ${flight.weather.wind.speed} kts${flight.weather.wind.gust ? ` G${flight.weather.wind.gust}` : \"\"}\n${flight.weather.ceiling ? `- Ceiling: ${flight.weather.ceiling} ft` : \"\"}\n` : \"Weather data not available\";\n    const emailBody = `\nAviation Intelligence Brain - Flight Safety Audit Report\n═══════════════════════════════════════════════════════════\n\n${statusEmoji} OVERALL STATUS: ${statusText}\n\nFlight Details:\n───────────────────────────────────────────────────────────\nPilot: ${pilot.name}\nAircraft: ${aircraft.tailNumber} (${aircraft.model})\nDate: ${new Date(flight.scheduledDate).toLocaleDateString()}\nDeparture: ${flight.departureAirport}\n${flight.arrivalAirport ? `Arrival: ${flight.arrivalAirport}` : \"\"}\n\nLegality Checks:\n───────────────────────────────────────────────────────────\n${checkSummary}\n\n${weatherSummary}\n\n═══════════════════════════════════════════════════════════\nThis is an automated safety briefing from Aviation Intelligence Brain.\nAlways verify information independently before flight.\n  `.trim();\n    try {\n        const { data, error } = await resend.emails.send({\n            from: \"Aviation Intelligence <safety@yourdomain.com>\",\n            to: [\n                pilot.email\n            ],\n            subject: `${statusEmoji} Flight Audit: ${aircraft.tailNumber} - ${statusText}`,\n            text: emailBody\n        });\n        if (error) {\n            console.error(\"Email send error:\", error);\n            return {\n                success: false,\n                message: error.message\n            };\n        }\n        return {\n            success: true,\n            message: \"Email sent successfully\",\n            id: data?.id\n        };\n    } catch (error) {\n        console.error(\"Email service error:\", error);\n        return {\n            success: false,\n            message: error.message\n        };\n    }\n}\n// Generate HTML version of the audit report\nfunction generateAuditHTML(flight) {\n    const pilot = flight.pilot;\n    const aircraft = flight.aircraft;\n    const statusColor = flight.overallStatus === \"go\" ? \"#10b981\" : flight.overallStatus === \"caution\" ? \"#f59e0b\" : \"#ef4444\";\n    const statusText = flight.overallStatus === \"go\" ? \"GO - Flight Approved\" : flight.overallStatus === \"caution\" ? \"CAUTION - Review Required\" : \"NO-GO - Flight Not Recommended\";\n    const checksHTML = flight.legalityChecks.map((check)=>{\n        const color = check.status === \"pass\" ? \"#10b981\" : check.status === \"warning\" ? \"#f59e0b\" : \"#ef4444\";\n        return `\n      <tr>\n        <td style=\"padding: 8px; border-bottom: 1px solid #e5e7eb;\">\n          <span style=\"display: inline-block; width: 12px; height: 12px; border-radius: 50%; background: ${color}; margin-right: 8px;\"></span>\n          ${check.item}\n        </td>\n        <td style=\"padding: 8px; border-bottom: 1px solid #e5e7eb;\">${check.message}</td>\n      </tr>\n    `;\n    }).join(\"\");\n    return `\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"utf-8\">\n  <title>Flight Audit Report</title>\n</head>\n<body style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;\">\n  <div style=\"background: ${statusColor}; color: white; padding: 20px; border-radius: 8px; text-align: center; margin-bottom: 20px;\">\n    <h1 style=\"margin: 0; font-size: 24px;\">${statusText}</h1>\n  </div>\n\n  <div style=\"background: #f9fafb; padding: 16px; border-radius: 8px; margin-bottom: 20px;\">\n    <h2 style=\"margin: 0 0 12px 0; font-size: 18px;\">Flight Details</h2>\n    <p style=\"margin: 4px 0;\"><strong>Pilot:</strong> ${pilot?.name || \"N/A\"}</p>\n    <p style=\"margin: 4px 0;\"><strong>Aircraft:</strong> ${aircraft?.tailNumber || \"N/A\"} (${aircraft?.model || \"N/A\"})</p>\n    <p style=\"margin: 4px 0;\"><strong>Date:</strong> ${new Date(flight.scheduledDate).toLocaleDateString()}</p>\n    <p style=\"margin: 4px 0;\"><strong>Departure:</strong> ${flight.departureAirport}</p>\n  </div>\n\n  <h2 style=\"font-size: 18px;\">Legality Checks</h2>\n  <table style=\"width: 100%; border-collapse: collapse;\">\n    ${checksHTML}\n  </table>\n\n  <p style=\"color: #6b7280; font-size: 12px; margin-top: 20px; text-align: center;\">\n    This is an automated safety briefing from Aviation Intelligence Brain.\n    Always verify information independently before flight.\n  </p>\n</body>\n</html>\n  `;\n}\nasync function sendThreatAlert(email, flight, threats) {\n    if (!resend) {\n        console.warn(\"Resend API key not configured - threat alert not sent\");\n        return {\n            success: false,\n            message: \"Email service not configured\"\n        };\n    }\n    const aircraft = flight.aircraft;\n    const threatList = threats.map((t)=>`- ${t}`).join(\"\\n\");\n    const emailBody = `\n⚠️ URGENT: Flight Status Changed to NO-GO\n═══════════════════════════════════════════════════════════\n\nNew threats have been detected for your upcoming flight:\n\nFlight Details:\nAircraft: ${aircraft?.tailNumber || \"Unknown\"}\nDeparture: ${flight.departureAirport}\nDate: ${new Date(flight.scheduledDate).toLocaleDateString()}\n\nDETECTED THREATS:\n───────────────────────────────────────────────────────────\n${threatList}\n\nPlease review your flight plan immediately.\n═══════════════════════════════════════════════════════════\n`.trim();\n    try {\n        const { data, error } = await resend.emails.send({\n            from: \"Aviation Intelligence <safety@yourdomain.com>\",\n            to: [\n                email\n            ],\n            subject: `⚠️ THREAT ALERT: Flight ${aircraft?.tailNumber || \"\"} Status Changed`,\n            text: emailBody\n        });\n        if (error) {\n            console.error(\"Threat email error:\", error);\n            return {\n                success: false,\n                message: error.message\n            };\n        }\n        return {\n            success: true,\n            message: \"Threat alert sent\",\n            id: data?.id\n        };\n    } catch (error) {\n        console.error(\"Threat email service error:\", error);\n        return {\n            success: false,\n            message: error.message\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dkMsVUFBVXlCLGNBQWMsR0FBRyxlQUFlLENBQUM7WUFDL0VlLE1BQU1qQjtRQUNSO1FBRUEsSUFBSVcsT0FBTztZQUNUdkMsUUFBUXVDLEtBQUssQ0FBQyx1QkFBdUJBO1lBQ3JDLE9BQU87Z0JBQUVyQyxTQUFTO2dCQUFPQyxTQUFTb0MsTUFBTXBDLE9BQU87WUFBQztRQUNsRDtRQUVBLE9BQU87WUFBRUQsU0FBUztZQUFNQyxTQUFTO1lBQXFCMkMsSUFBSVIsTUFBTVE7UUFBRztJQUNyRSxFQUFFLE9BQU9QLE9BQU87UUFDZHZDLFFBQVF1QyxLQUFLLENBQUMsK0JBQStCQTtRQUM3QyxPQUFPO1lBQUVyQyxTQUFTO1lBQU9DLFNBQVMsTUFBaUJBLE9BQU87UUFBQztJQUM3RDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXZpYXRpb24taW50ZWxsaWdlbmNlLWJyYWluLy4vbGliL3NlcnZpY2VzL2VtYWlsU2VydmljZS50cz9kMzk4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJlc2VuZCB9IGZyb20gJ3Jlc2VuZCc7XG5pbXBvcnQgeyBJRmxpZ2h0IH0gZnJvbSAnLi4vbW9kZWxzL0ZsaWdodCc7XG5cbmNvbnN0IHJlc2VuZCA9IHByb2Nlc3MuZW52LlJFU0VORF9BUElfS0VZID8gbmV3IFJlc2VuZChwcm9jZXNzLmVudi5SRVNFTkRfQVBJX0tFWSkgOiBudWxsO1xuXG5pbnRlcmZhY2UgRW1haWxSZXN1bHQge1xuICBzdWNjZXNzOiBib29sZWFuO1xuICBtZXNzYWdlOiBzdHJpbmc7XG4gIGlkPzogc3RyaW5nO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2VuZEF1ZGl0RW1haWwoZmxpZ2h0OiBJRmxpZ2h0KTogUHJvbWlzZTxFbWFpbFJlc3VsdD4ge1xuICBpZiAoIXJlc2VuZCkge1xuICAgIGNvbnNvbGUud2FybignUmVzZW5kIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQgLSBlbWFpbCBub3Qgc2VudCcpO1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIG1lc3NhZ2U6ICdFbWFpbCBzZXJ2aWNlIG5vdCBjb25maWd1cmVkJyxcbiAgICB9O1xuICB9XG5cbiAgY29uc3QgcGlsb3QgPSBmbGlnaHQucGlsb3QgYXMgYW55O1xuICBjb25zdCBhaXJjcmFmdCA9IGZsaWdodC5haXJjcmFmdCBhcyBhbnk7XG5cbiAgaWYgKCFwaWxvdD8uZW1haWwpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBtZXNzYWdlOiAnUGlsb3QgZW1haWwgbm90IGZvdW5kJyxcbiAgICB9O1xuICB9XG5cbiAgY29uc3Qgc3RhdHVzRW1vamkgPVxuICAgIGZsaWdodC5vdmVyYWxsU3RhdHVzID09PSAnZ28nXG4gICAgICA/ICfinIUnXG4gICAgICA6IGZsaWdodC5vdmVyYWxsU3RhdHVzID09PSAnY2F1dGlvbidcbiAgICAgICAgPyAn4pqg77iPJ1xuICAgICAgICA6ICfinYwnO1xuXG4gIGNvbnN0IHN0YXR1c1RleHQgPVxuICAgIGZsaWdodC5vdmVyYWxsU3RhdHVzID09PSAnZ28nXG4gICAgICA/ICdHTyAtIEZsaWdodCBBcHByb3ZlZCdcbiAgICAgIDogZmxpZ2h0Lm92ZXJhbGxTdGF0dXMgPT09ICdjYXV0aW9uJ1xuICAgICAgICA/ICdDQVVUSU9OIC0gUmV2aWV3IFJlcXVpcmVkJ1xuICAgICAgICA6ICdOTy1HTyAtIEZsaWdodCBOb3QgUmVjb21tZW5kZWQnO1xuXG4gIC8vIEJ1aWxkIGNoZWNrIHN1bW1hcnlcbiAgY29uc3QgY2hlY2tTdW1tYXJ5ID0gZmxpZ2h0LmxlZ2FsaXR5Q2hlY2tzXG4gICAgLm1hcCgoY2hlY2spID0+IHtcbiAgICAgIGNvbnN0IGljb24gPSBjaGVjay5zdGF0dXMgPT09ICdwYXNzJyA/ICfinIUnIDogY2hlY2suc3RhdHVzID09PSAnd2FybmluZycgPyAn4pqg77iPJyA6ICfinYwnO1xuICAgICAgcmV0dXJuIGAke2ljb259ICR7Y2hlY2suaXRlbX06ICR7Y2hlY2subWVzc2FnZX1gO1xuICAgIH0pXG4gICAgLmpvaW4oJ1xcbicpO1xuXG4gIC8vIFdlYXRoZXIgc3VtbWFyeVxuICBjb25zdCB3ZWF0aGVyU3VtbWFyeSA9IGZsaWdodC53ZWF0aGVyXG4gICAgPyBgXG5XZWF0aGVyIGF0ICR7ZmxpZ2h0LndlYXRoZXIuc3RhdGlvbn06XG4tIENvbmRpdGlvbnM6ICR7ZmxpZ2h0LndlYXRoZXIuZmxpZ2h0Q2F0ZWdvcnl9XG4tIFZpc2liaWxpdHk6ICR7ZmxpZ2h0LndlYXRoZXIudmlzaWJpbGl0eX0gU01cbi0gV2luZDogJHtmbGlnaHQud2VhdGhlci53aW5kLmRpcmVjdGlvbn3CsCBhdCAke2ZsaWdodC53ZWF0aGVyLndpbmQuc3BlZWR9IGt0cyR7ZmxpZ2h0LndlYXRoZXIud2luZC5ndXN0ID8gYCBHJHtmbGlnaHQud2VhdGhlci53aW5kLmd1c3R9YCA6ICcnXG4gICAgfVxuJHtmbGlnaHQud2VhdGhlci5jZWlsaW5nID8gYC0gQ2VpbGluZzogJHtmbGlnaHQud2VhdGhlci5jZWlsaW5nfSBmdGAgOiAnJ31cbmBcbiAgICA6ICdXZWF0aGVyIGRhdGEgbm90IGF2YWlsYWJsZSc7XG5cbiAgY29uc3QgZW1haWxCb2R5ID0gYFxuQXZpYXRpb24gSW50ZWxsaWdlbmNlIEJyYWluIC0gRmxpZ2h0IFNhZmV0eSBBdWRpdCBSZXBvcnRcbuKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkFxuXG4ke3N0YXR1c0Vtb2ppfSBPVkVSQUxMIFNUQVRVUzogJHtzdGF0dXNUZXh0fVxuXG5GbGlnaHQgRGV0YWlsczpcbuKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgFxuUGlsb3Q6ICR7cGlsb3QubmFtZX1cbkFpcmNyYWZ0OiAke2FpcmNyYWZ0LnRhaWxOdW1iZXJ9ICgke2FpcmNyYWZ0Lm1vZGVsfSlcbkRhdGU6ICR7bmV3IERhdGUoZmxpZ2h0LnNjaGVkdWxlZERhdGUpLnRvTG9jYWxlRGF0ZVN0cmluZygpfVxuRGVwYXJ0dXJlOiAke2ZsaWdodC5kZXBhcnR1cmVBaXJwb3J0fVxuJHtmbGlnaHQuYXJyaXZhbEFpcnBvcnQgPyBgQXJyaXZhbDogJHtmbGlnaHQuYXJyaXZhbEFpcnBvcnR9YCA6ICcnfVxuXG5MZWdhbGl0eSBDaGVja3M6XG7ilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIBcbiR7Y2hlY2tTdW1tYXJ5fVxuXG4ke3dlYXRoZXJTdW1tYXJ5fVxuXG7ilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZBcblRoaXMgaXMgYW4gYXV0b21hdGVkIHNhZmV0eSBicmllZmluZyBmcm9tIEF2aWF0aW9uIEludGVsbGlnZW5jZSBCcmFpbi5cbkFsd2F5cyB2ZXJpZnkgaW5mb3JtYXRpb24gaW5kZXBlbmRlbnRseSBiZWZvcmUgZmxpZ2h0LlxuICBgLnRyaW0oKTtcblxuICB0cnkge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHJlc2VuZC5lbWFpbHMuc2VuZCh7XG4gICAgICBmcm9tOiAnQXZpYXRpb24gSW50ZWxsaWdlbmNlIDxzYWZldHlAeW91cmRvbWFpbi5jb20+JyxcbiAgICAgIHRvOiBbcGlsb3QuZW1haWxdLFxuICAgICAgc3ViamVjdDogYCR7c3RhdHVzRW1vaml9IEZsaWdodCBBdWRpdDogJHthaXJjcmFmdC50YWlsTnVtYmVyfSAtICR7c3RhdHVzVGV4dH1gLFxuICAgICAgdGV4dDogZW1haWxCb2R5LFxuICAgIH0pO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFbWFpbCBzZW5kIGVycm9yOicsIGVycm9yKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6ICdFbWFpbCBzZW50IHN1Y2Nlc3NmdWxseScsXG4gICAgICBpZDogZGF0YT8uaWQsXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFbWFpbCBzZXJ2aWNlIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBtZXNzYWdlOiAoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UsXG4gICAgfTtcbiAgfVxufVxuXG4vLyBHZW5lcmF0ZSBIVE1MIHZlcnNpb24gb2YgdGhlIGF1ZGl0IHJlcG9ydFxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlQXVkaXRIVE1MKGZsaWdodDogSUZsaWdodCk6IHN0cmluZyB7XG4gIGNvbnN0IHBpbG90ID0gZmxpZ2h0LnBpbG90IGFzIGFueTtcbiAgY29uc3QgYWlyY3JhZnQgPSBmbGlnaHQuYWlyY3JhZnQgYXMgYW55O1xuXG4gIGNvbnN0IHN0YXR1c0NvbG9yID1cbiAgICBmbGlnaHQub3ZlcmFsbFN0YXR1cyA9PT0gJ2dvJ1xuICAgICAgPyAnIzEwYjk4MSdcbiAgICAgIDogZmxpZ2h0Lm92ZXJhbGxTdGF0dXMgPT09ICdjYXV0aW9uJ1xuICAgICAgICA/ICcjZjU5ZTBiJ1xuICAgICAgICA6ICcjZWY0NDQ0JztcblxuICBjb25zdCBzdGF0dXNUZXh0ID1cbiAgICBmbGlnaHQub3ZlcmFsbFN0YXR1cyA9PT0gJ2dvJ1xuICAgICAgPyAnR08gLSBGbGlnaHQgQXBwcm92ZWQnXG4gICAgICA6IGZsaWdodC5vdmVyYWxsU3RhdHVzID09PSAnY2F1dGlvbidcbiAgICAgICAgPyAnQ0FVVElPTiAtIFJldmlldyBSZXF1aXJlZCdcbiAgICAgICAgOiAnTk8tR08gLSBGbGlnaHQgTm90IFJlY29tbWVuZGVkJztcblxuICBjb25zdCBjaGVja3NIVE1MID0gZmxpZ2h0LmxlZ2FsaXR5Q2hlY2tzXG4gICAgLm1hcCgoY2hlY2spID0+IHtcbiAgICAgIGNvbnN0IGNvbG9yID1cbiAgICAgICAgY2hlY2suc3RhdHVzID09PSAncGFzcycgPyAnIzEwYjk4MScgOiBjaGVjay5zdGF0dXMgPT09ICd3YXJuaW5nJyA/ICcjZjU5ZTBiJyA6ICcjZWY0NDQ0JztcbiAgICAgIHJldHVybiBgXG4gICAgICA8dHI+XG4gICAgICAgIDx0ZCBzdHlsZT1cInBhZGRpbmc6IDhweDsgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNlNWU3ZWI7XCI+XG4gICAgICAgICAgPHNwYW4gc3R5bGU9XCJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdpZHRoOiAxMnB4OyBoZWlnaHQ6IDEycHg7IGJvcmRlci1yYWRpdXM6IDUwJTsgYmFja2dyb3VuZDogJHtjb2xvcn07IG1hcmdpbi1yaWdodDogOHB4O1wiPjwvc3Bhbj5cbiAgICAgICAgICAke2NoZWNrLml0ZW19XG4gICAgICAgIDwvdGQ+XG4gICAgICAgIDx0ZCBzdHlsZT1cInBhZGRpbmc6IDhweDsgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNlNWU3ZWI7XCI+JHtjaGVjay5tZXNzYWdlfTwvdGQ+XG4gICAgICA8L3RyPlxuICAgIGA7XG4gICAgfSlcbiAgICAuam9pbignJyk7XG5cbiAgcmV0dXJuIGBcbjwhRE9DVFlQRSBodG1sPlxuPGh0bWw+XG48aGVhZD5cbiAgPG1ldGEgY2hhcnNldD1cInV0Zi04XCI+XG4gIDx0aXRsZT5GbGlnaHQgQXVkaXQgUmVwb3J0PC90aXRsZT5cbjwvaGVhZD5cbjxib2R5IHN0eWxlPVwiZm9udC1mYW1pbHk6IC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgJ1NlZ29lIFVJJywgUm9ib3RvLCBzYW5zLXNlcmlmOyBtYXgtd2lkdGg6IDYwMHB4OyBtYXJnaW46IDAgYXV0bzsgcGFkZGluZzogMjBweDtcIj5cbiAgPGRpdiBzdHlsZT1cImJhY2tncm91bmQ6ICR7c3RhdHVzQ29sb3J9OyBjb2xvcjogd2hpdGU7IHBhZGRpbmc6IDIwcHg7IGJvcmRlci1yYWRpdXM6IDhweDsgdGV4dC1hbGlnbjogY2VudGVyOyBtYXJnaW4tYm90dG9tOiAyMHB4O1wiPlxuICAgIDxoMSBzdHlsZT1cIm1hcmdpbjogMDsgZm9udC1zaXplOiAyNHB4O1wiPiR7c3RhdHVzVGV4dH08L2gxPlxuICA8L2Rpdj5cblxuICA8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZDogI2Y5ZmFmYjsgcGFkZGluZzogMTZweDsgYm9yZGVyLXJhZGl1czogOHB4OyBtYXJnaW4tYm90dG9tOiAyMHB4O1wiPlxuICAgIDxoMiBzdHlsZT1cIm1hcmdpbjogMCAwIDEycHggMDsgZm9udC1zaXplOiAxOHB4O1wiPkZsaWdodCBEZXRhaWxzPC9oMj5cbiAgICA8cCBzdHlsZT1cIm1hcmdpbjogNHB4IDA7XCI+PHN0cm9uZz5QaWxvdDo8L3N0cm9uZz4gJHtwaWxvdD8ubmFtZSB8fCAnTi9BJ308L3A+XG4gICAgPHAgc3R5bGU9XCJtYXJnaW46IDRweCAwO1wiPjxzdHJvbmc+QWlyY3JhZnQ6PC9zdHJvbmc+ICR7YWlyY3JhZnQ/LnRhaWxOdW1iZXIgfHwgJ04vQSd9ICgke2FpcmNyYWZ0Py5tb2RlbCB8fCAnTi9BJ30pPC9wPlxuICAgIDxwIHN0eWxlPVwibWFyZ2luOiA0cHggMDtcIj48c3Ryb25nPkRhdGU6PC9zdHJvbmc+ICR7bmV3IERhdGUoZmxpZ2h0LnNjaGVkdWxlZERhdGUpLnRvTG9jYWxlRGF0ZVN0cmluZygpfTwvcD5cbiAgICA8cCBzdHlsZT1cIm1hcmdpbjogNHB4IDA7XCI+PHN0cm9uZz5EZXBhcnR1cmU6PC9zdHJvbmc+ICR7ZmxpZ2h0LmRlcGFydHVyZUFpcnBvcnR9PC9wPlxuICA8L2Rpdj5cblxuICA8aDIgc3R5bGU9XCJmb250LXNpemU6IDE4cHg7XCI+TGVnYWxpdHkgQ2hlY2tzPC9oMj5cbiAgPHRhYmxlIHN0eWxlPVwid2lkdGg6IDEwMCU7IGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7XCI+XG4gICAgJHtjaGVja3NIVE1MfVxuICA8L3RhYmxlPlxuXG4gIDxwIHN0eWxlPVwiY29sb3I6ICM2YjcyODA7IGZvbnQtc2l6ZTogMTJweDsgbWFyZ2luLXRvcDogMjBweDsgdGV4dC1hbGlnbjogY2VudGVyO1wiPlxuICAgIFRoaXMgaXMgYW4gYXV0b21hdGVkIHNhZmV0eSBicmllZmluZyBmcm9tIEF2aWF0aW9uIEludGVsbGlnZW5jZSBCcmFpbi5cbiAgICBBbHdheXMgdmVyaWZ5IGluZm9ybWF0aW9uIGluZGVwZW5kZW50bHkgYmVmb3JlIGZsaWdodC5cbiAgPC9wPlxuPC9ib2R5PlxuPC9odG1sPlxuICBgO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2VuZFRocmVhdEFsZXJ0KGVtYWlsOiBzdHJpbmcsIGZsaWdodDogSUZsaWdodCwgdGhyZWF0czogc3RyaW5nW10pOiBQcm9taXNlPEVtYWlsUmVzdWx0PiB7XG4gIGlmICghcmVzZW5kKSB7XG4gICAgY29uc29sZS53YXJuKCdSZXNlbmQgQVBJIGtleSBub3QgY29uZmlndXJlZCAtIHRocmVhdCBhbGVydCBub3Qgc2VudCcpO1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiAnRW1haWwgc2VydmljZSBub3QgY29uZmlndXJlZCcgfTtcbiAgfVxuXG4gIGNvbnN0IGFpcmNyYWZ0ID0gZmxpZ2h0LmFpcmNyYWZ0IGFzIGFueTtcbiAgY29uc3QgdGhyZWF0TGlzdCA9IHRocmVhdHMubWFwKHQgPT4gYC0gJHt0fWApLmpvaW4oJ1xcbicpO1xuXG4gIGNvbnN0IGVtYWlsQm9keSA9IGBcbuKaoO+4jyBVUkdFTlQ6IEZsaWdodCBTdGF0dXMgQ2hhbmdlZCB0byBOTy1HT1xu4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQXG5cbk5ldyB0aHJlYXRzIGhhdmUgYmVlbiBkZXRlY3RlZCBmb3IgeW91ciB1cGNvbWluZyBmbGlnaHQ6XG5cbkZsaWdodCBEZXRhaWxzOlxuQWlyY3JhZnQ6ICR7YWlyY3JhZnQ/LnRhaWxOdW1iZXIgfHwgJ1Vua25vd24nfVxuRGVwYXJ0dXJlOiAke2ZsaWdodC5kZXBhcnR1cmVBaXJwb3J0fVxuRGF0ZTogJHtuZXcgRGF0ZShmbGlnaHQuc2NoZWR1bGVkRGF0ZSkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9XG5cbkRFVEVDVEVEIFRIUkVBVFM6XG7ilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIBcbiR7dGhyZWF0TGlzdH1cblxuUGxlYXNlIHJldmlldyB5b3VyIGZsaWdodCBwbGFuIGltbWVkaWF0ZWx5Llxu4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQXG5gLnRyaW0oKTtcblxuICB0cnkge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHJlc2VuZC5lbWFpbHMuc2VuZCh7XG4gICAgICBmcm9tOiAnQXZpYXRpb24gSW50ZWxsaWdlbmNlIDxzYWZldHlAeW91cmRvbWFpbi5jb20+JyxcbiAgICAgIHRvOiBbZW1haWxdLFxuICAgICAgc3ViamVjdDogYOKaoO+4jyBUSFJFQVQgQUxFUlQ6IEZsaWdodCAke2FpcmNyYWZ0Py50YWlsTnVtYmVyIHx8ICcnfSBTdGF0dXMgQ2hhbmdlZGAsXG4gICAgICB0ZXh0OiBlbWFpbEJvZHksXG4gICAgfSk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1RocmVhdCBlbWFpbCBlcnJvcjonLCBlcnJvcik7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogZXJyb3IubWVzc2FnZSB9O1xuICAgIH1cblxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIG1lc3NhZ2U6ICdUaHJlYXQgYWxlcnQgc2VudCcsIGlkOiBkYXRhPy5pZCB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1RocmVhdCBlbWFpbCBzZXJ2aWNlIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlIH07XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJSZXNlbmQiLCJyZXNlbmQiLCJwcm9jZXNzIiwiZW52IiwiUkVTRU5EX0FQSV9LRVkiLCJzZW5kQXVkaXRFbWFpbCIsImZsaWdodCIsImNvbnNvbGUiLCJ3YXJuIiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJwaWxvdCIsImFpcmNyYWZ0IiwiZW1haWwiLCJzdGF0dXNFbW9qaSIsIm92ZXJhbGxTdGF0dXMiLCJzdGF0dXNUZXh0IiwiY2hlY2tTdW1tYXJ5IiwibGVnYWxpdHlDaGVja3MiLCJtYXAiLCJjaGVjayIsImljb24iLCJzdGF0dXMiLCJpdGVtIiwiam9pbiIsIndlYXRoZXJTdW1tYXJ5Iiwid2VhdGhlciIsInN0YXRpb24iLCJmbGlnaHRDYXRlZ29yeSIsInZpc2liaWxpdHkiLCJ3aW5kIiwiZGlyZWN0aW9uIiwic3BlZWQiLCJndXN0IiwiY2VpbGluZyIsImVtYWlsQm9keSIsIm5hbWUiLCJ0YWlsTnVtYmVyIiwibW9kZWwiLCJEYXRlIiwic2NoZWR1bGVkRGF0ZSIsInRvTG9jYWxlRGF0ZVN0cmluZyIsImRlcGFydHVyZUFpcnBvcnQiLCJhcnJpdmFsQWlycG9ydCIsInRyaW0iLCJkYXRhIiwiZXJyb3IiLCJlbWFpbHMiLCJzZW5kIiwiZnJvbSIsInRvIiwic3ViamVjdCIsInRleHQiLCJpZCIsImdlbmVyYXRlQXVkaXRIVE1MIiwic3RhdHVzQ29sb3IiLCJjaGVja3NIVE1MIiwiY29sb3IiLCJzZW5kVGhyZWF0QWxlcnQiLCJ0aHJlYXRzIiwidGhyZWF0TGlzdCIsInQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/services/emailService.ts\n");

/***/ }),

/***/ "(rsc)/./lib/services/legalityService.ts":
/*!*****************************************!*\
  !*** ./lib/services/legalityService.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   runLegalityAudit: () => (/* binding */ runLegalityAudit),\n/* harmony export */   runOfflineAudit: () => (/* binding */ runOfflineAudit)\n/* harmony export */ });\n/* harmony import */ var _lib_models_Flight__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/models/Flight */ \"(rsc)/./lib/models/Flight.ts\");\n/* harmony import */ var _weatherService__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./weatherService */ \"(rsc)/./lib/services/weatherService.ts\");\n// Legality Service - Core compliance engine for flight audits\n// Determines Go/Caution/No-Go based on FAA regulations\n\n\n// ============================================\n// MAINTENANCE CHECKS\n// ============================================\nfunction checkAnnualInspection(aircraft, asOf) {\n    const annualDate = new Date(aircraft.maintenanceDates.annual);\n    const oneYearLater = new Date(annualDate);\n    oneYearLater.setFullYear(oneYearLater.getFullYear() + 1);\n    const isOverdue = asOf > oneYearLater;\n    const daysUntilDue = Math.floor((oneYearLater.getTime() - asOf.getTime()) / 86400000);\n    if (isOverdue) {\n        return {\n            category: \"maintenance\",\n            item: \"Annual Inspection\",\n            status: \"fail\",\n            message: `Annual overdue by ${Math.abs(daysUntilDue)} days`,\n            details: `Last annual: ${annualDate.toLocaleDateString()}`\n        };\n    }\n    if (daysUntilDue <= 30) {\n        return {\n            category: \"maintenance\",\n            item: \"Annual Inspection\",\n            status: \"warning\",\n            message: `Annual due in ${daysUntilDue} days`,\n            details: `Due by: ${oneYearLater.toLocaleDateString()}`\n        };\n    }\n    return {\n        category: \"maintenance\",\n        item: \"Annual Inspection\",\n        status: \"pass\",\n        message: `Annual valid until ${oneYearLater.toLocaleDateString()}`\n    };\n}\nfunction checkTransponder(aircraft, asOf) {\n    const transponderDate = new Date(aircraft.maintenanceDates.transponder);\n    const twoYearsLater = new Date(transponderDate);\n    twoYearsLater.setMonth(twoYearsLater.getMonth() + 24);\n    const isOverdue = asOf > twoYearsLater;\n    const daysUntilDue = Math.floor((twoYearsLater.getTime() - asOf.getTime()) / 86400000);\n    if (isOverdue) {\n        return {\n            category: \"maintenance\",\n            item: \"Transponder Check\",\n            status: \"fail\",\n            message: `Transponder check overdue by ${Math.abs(daysUntilDue)} days`,\n            details: `Last check: ${transponderDate.toLocaleDateString()}`\n        };\n    }\n    if (daysUntilDue <= 60) {\n        return {\n            category: \"maintenance\",\n            item: \"Transponder Check\",\n            status: \"warning\",\n            message: `Transponder due in ${daysUntilDue} days`\n        };\n    }\n    return {\n        category: \"maintenance\",\n        item: \"Transponder Check\",\n        status: \"pass\",\n        message: `Transponder valid until ${twoYearsLater.toLocaleDateString()}`\n    };\n}\nfunction checkStaticSystem(aircraft, asOf, isIFR) {\n    if (!isIFR) {\n        return {\n            category: \"maintenance\",\n            item: \"Static System (IFR)\",\n            status: \"pass\",\n            message: \"N/A for VFR flight\"\n        };\n    }\n    const staticDate = new Date(aircraft.maintenanceDates.staticSystem);\n    const twoYearsLater = new Date(staticDate);\n    twoYearsLater.setMonth(twoYearsLater.getMonth() + 24);\n    const isOverdue = asOf > twoYearsLater;\n    const daysUntilDue = Math.floor((twoYearsLater.getTime() - asOf.getTime()) / 86400000);\n    if (isOverdue) {\n        return {\n            category: \"maintenance\",\n            item: \"Static System (IFR)\",\n            status: \"fail\",\n            message: `Static system check overdue for IFR`,\n            details: `Last check: ${staticDate.toLocaleDateString()}`\n        };\n    }\n    return {\n        category: \"maintenance\",\n        item: \"Static System (IFR)\",\n        status: \"pass\",\n        message: `Static system valid until ${twoYearsLater.toLocaleDateString()}`\n    };\n}\nfunction checkHundredHour(aircraft, asOf, isForHire) {\n    if (!isForHire || !aircraft.maintenanceDates.hundredHour) {\n        return {\n            category: \"maintenance\",\n            item: \"100-Hour Inspection\",\n            status: \"pass\",\n            message: \"N/A (not for-hire)\"\n        };\n    }\n    // Find last 100-hour from logs or maintenanceDates\n    const lastHundredHour = aircraft.maintenanceDates.hundredHour;\n    const lastLog = aircraft.logs?.find((l)=>l.description.toLowerCase().includes(\"100\"));\n    const lastTachAtHundred = lastLog?.tachTime || 0;\n    const currentTach = aircraft.currentHours.tach;\n    const hoursSince = currentTach - lastTachAtHundred;\n    if (hoursSince >= 100) {\n        return {\n            category: \"maintenance\",\n            item: \"100-Hour Inspection\",\n            status: \"fail\",\n            message: `100-hour overdue by ${(hoursSince - 100).toFixed(1)} hours`,\n            details: `Current tach: ${currentTach}, Last 100-hr at: ${lastTachAtHundred}`\n        };\n    }\n    if (hoursSince >= 90) {\n        return {\n            category: \"maintenance\",\n            item: \"100-Hour Inspection\",\n            status: \"warning\",\n            message: `100-hour due in ${(100 - hoursSince).toFixed(1)} hours`\n        };\n    }\n    return {\n        category: \"maintenance\",\n        item: \"100-Hour Inspection\",\n        status: \"pass\",\n        message: `100-hour not due for ${(100 - hoursSince).toFixed(1)} more hours`\n    };\n}\n// ============================================\n// PILOT CURRENCY CHECKS\n// ============================================\nfunction checkMedical(pilot, asOf) {\n    const medicalExp = new Date(pilot.medicalExpiration);\n    const isExpired = asOf > medicalExp;\n    const daysUntilExp = Math.floor((medicalExp.getTime() - asOf.getTime()) / 86400000);\n    if (isExpired) {\n        return {\n            category: \"pilot\",\n            item: \"Medical Certificate\",\n            status: \"fail\",\n            message: `Medical expired on ${medicalExp.toLocaleDateString()}`\n        };\n    }\n    if (daysUntilExp <= 30) {\n        return {\n            category: \"pilot\",\n            item: \"Medical Certificate\",\n            status: \"warning\",\n            message: `Medical expires in ${daysUntilExp} days`\n        };\n    }\n    return {\n        category: \"pilot\",\n        item: \"Medical Certificate\",\n        status: \"pass\",\n        message: `Medical valid until ${medicalExp.toLocaleDateString()}`\n    };\n}\nfunction checkFlightReview(pilot, asOf) {\n    const bfrExp = new Date(pilot.flightReviewExpiration);\n    const isExpired = asOf > bfrExp;\n    const daysUntilExp = Math.floor((bfrExp.getTime() - asOf.getTime()) / 86400000);\n    if (isExpired) {\n        return {\n            category: \"pilot\",\n            item: \"Flight Review (BFR)\",\n            status: \"fail\",\n            message: `Flight review expired on ${bfrExp.toLocaleDateString()}`\n        };\n    }\n    if (daysUntilExp <= 30) {\n        return {\n            category: \"pilot\",\n            item: \"Flight Review (BFR)\",\n            status: \"warning\",\n            message: `Flight review expires in ${daysUntilExp} days`\n        };\n    }\n    return {\n        category: \"pilot\",\n        item: \"Flight Review (BFR)\",\n        status: \"pass\",\n        message: `Flight review valid until ${bfrExp.toLocaleDateString()}`\n    };\n}\n// ============================================\n// WEATHER / SAFETY CHECKS\n// ============================================\nfunction checkWeatherVsPilot(flightCategory, wind, pilot) {\n    const checks = [];\n    // IFR/LIFR conditions check\n    if ((flightCategory === \"IFR\" || flightCategory === \"LIFR\") && !pilot.certificates.instrumentRated) {\n        checks.push({\n            category: \"safety\",\n            item: \"Weather vs. Ratings\",\n            status: \"fail\",\n            message: `${flightCategory} conditions require instrument rating`,\n            details: `Pilot ${pilot.name} is VFR-only`\n        });\n    } else if (flightCategory === \"MVFR\" && (pilot.experience?.totalHours || 0) < 100) {\n        checks.push({\n            category: \"safety\",\n            item: \"Weather vs. Experience\",\n            status: \"warning\",\n            message: \"MVFR conditions not recommended for low-time pilots\",\n            details: `Pilot has ${pilot.experience?.totalHours || 0} total hours`\n        });\n    } else {\n        checks.push({\n            category: \"safety\",\n            item: \"Weather vs. Ratings\",\n            status: \"pass\",\n            message: `${flightCategory} conditions OK for pilot qualifications`\n        });\n    }\n    // Wind checks\n    const maxWind = Math.max(wind.speed, wind.gust || 0);\n    if (maxWind >= 30) {\n        checks.push({\n            category: \"safety\",\n            item: \"Wind Conditions\",\n            status: \"fail\",\n            message: `Excessive winds: ${wind.speed}kts${wind.gust ? ` gusting ${wind.gust}kts` : \"\"}`\n        });\n    } else if (maxWind >= 20) {\n        checks.push({\n            category: \"safety\",\n            item: \"Wind Conditions\",\n            status: \"warning\",\n            message: `High winds: ${wind.speed}kts${wind.gust ? ` gusting ${wind.gust}kts` : \"\"}`\n        });\n    } else {\n        checks.push({\n            category: \"safety\",\n            item: \"Wind Conditions\",\n            status: \"pass\",\n            message: `Winds acceptable: ${wind.speed}kts`\n        });\n    }\n    return checks;\n}\n// ============================================\n// OVERALL STATUS CALCULATION\n// ============================================\nfunction calculateOverallStatus(checks) {\n    if (checks.some((c)=>c.status === \"fail\")) return \"no-go\";\n    if (checks.some((c)=>c.status === \"warning\")) return \"caution\";\n    return \"go\";\n}\nfunction generateSummary(checks, overallStatus) {\n    const failedChecks = checks.filter((c)=>c.status === \"fail\");\n    const warnings = checks.filter((c)=>c.status === \"warning\");\n    if (overallStatus === \"go\") {\n        return \"✅ All systems GO. Flight is legal and safe to operate.\";\n    }\n    let summary = overallStatus === \"no-go\" ? \"\\uD83D\\uDED1 FLIGHT GROUNDED\\n\\n\" : \"⚠️ FLIGHT CAUTION\\n\\n\";\n    if (failedChecks.length > 0) {\n        summary += \"Critical Issues:\\n\";\n        failedChecks.forEach((c)=>{\n            summary += `• ${c.item}: ${c.message}\\n`;\n        });\n        summary += \"\\n\";\n    }\n    if (warnings.length > 0) {\n        summary += \"Warnings:\\n\";\n        warnings.forEach((c)=>{\n            summary += `• ${c.item}: ${c.message}\\n`;\n        });\n    }\n    return summary;\n}\n// ============================================\n// MAIN AUDIT FUNCTION\n// ============================================\nasync function runLegalityAudit(flightId) {\n    // 1. Fetch flight with populated pilot & aircraft\n    const flight = await _lib_models_Flight__WEBPACK_IMPORTED_MODULE_0__[\"default\"].findById(flightId).populate(\"pilot\").populate(\"aircraft\").exec();\n    if (!flight) {\n        throw new Error(`Flight not found: ${flightId}`);\n    }\n    const pilot = flight.pilot;\n    const aircraft = flight.aircraft;\n    const scheduledDate = new Date(flight.scheduledDate);\n    if (!pilot || !aircraft) {\n        throw new Error(\"Flight missing pilot or aircraft reference\");\n    }\n    // 2. Fetch live weather\n    let weather = flight.weather;\n    try {\n        const fetchedWeather = await (0,_weatherService__WEBPACK_IMPORTED_MODULE_1__.fetchWeatherData)(flight.departureAirport);\n        if (fetchedWeather) {\n            weather = fetchedWeather;\n        }\n    } catch  {\n        console.warn(\"Weather fetch failed, using cached or defaults\");\n    }\n    // 3. Run all checks\n    const checks = [];\n    // Maintenance checks\n    checks.push(checkAnnualInspection(aircraft, scheduledDate));\n    checks.push(checkTransponder(aircraft, scheduledDate));\n    checks.push(checkStaticSystem(aircraft, scheduledDate, pilot.certificates?.instrumentRated || false));\n    checks.push(checkHundredHour(aircraft, scheduledDate, false)); // Assume not for-hire for demo\n    // Pilot currency checks\n    checks.push(checkMedical(pilot, scheduledDate));\n    checks.push(checkFlightReview(pilot, scheduledDate));\n    // Weather/safety checks\n    if (weather) {\n        const weatherChecks = checkWeatherVsPilot(weather.flightCategory, weather.wind, pilot);\n        checks.push(...weatherChecks);\n    }\n    // 4. Calculate overall status\n    const overallStatus = calculateOverallStatus(checks);\n    const summary = generateSummary(checks, overallStatus);\n    const riskScenarios = calculateRiskScenarios(aircraft, pilot, weather, scheduledDate);\n    // 5. Update flight document\n    flight.legalityChecks = checks;\n    flight.overallStatus = overallStatus;\n    if (weather) flight.weather = weather;\n    // SAVE SNAPSHOT\n    flight.safetyAnalysisSnapshot = {\n        checks,\n        overallStatus,\n        weather,\n        riskScenarios,\n        generatedAt: new Date()\n    };\n    await flight.save();\n    return {\n        overallStatus,\n        checks,\n        summary,\n        riskScenarios\n    };\n}\n// ============================================\n// RISK SCENARIO CALCULATION\n// ============================================\nfunction calculateRiskScenarios(aircraft, pilot, weather, scheduledDate) {\n    const scenarios = [];\n    const hour = scheduledDate.getHours();\n    const isNightFlight = hour >= 19 || hour <= 6;\n    const airframeHours = aircraft.currentHours.hobbs || 0;\n    // Alternator\n    const alternatorRisk = Math.min(Math.round(airframeHours % 500 / 500 * 15), 15);\n    let alternatorSeverity = \"low\";\n    if (isNightFlight && alternatorRisk > 5) alternatorSeverity = \"high\";\n    if (isNightFlight && (pilot.experience?.nightHours || 0) < 20) alternatorSeverity = \"critical\";\n    scenarios.push({\n        title: \"Electrical Failure\",\n        probability: alternatorRisk,\n        severity: alternatorSeverity,\n        description: isNightFlight ? `${alternatorRisk}% alternator failure risk. Night flight with ${pilot.experience?.nightHours || 0} night hours - NO LIGHTS/RADIOS would be catastrophic.` : `${alternatorRisk}% alternator failure risk. Daylight operations reduce severity.`\n    });\n    // Weather\n    if (weather) {\n        let wxRisk = 5;\n        if (weather.flightCategory === \"MVFR\") wxRisk = 20;\n        if (weather.flightCategory === \"IFR\") wxRisk = 40;\n        if (weather.flightCategory === \"LIFR\") wxRisk = 60;\n        const isIRPilot = pilot.certificates.instrumentRated;\n        let wxSeverity = \"low\";\n        if (wxRisk >= 20 && !isIRPilot) wxSeverity = \"high\";\n        if (wxRisk >= 40 && !isIRPilot) wxSeverity = \"critical\";\n        scenarios.push({\n            title: \"Weather Below Minimums\",\n            probability: wxRisk,\n            severity: wxSeverity,\n            description: !isIRPilot && wxRisk >= 20 ? `${weather.flightCategory} conditions with VFR-only pilot. If weather worsens, pilot lacks instrument capability.` : `Current: ${weather.flightCategory}. Ceiling ${weather.ceiling ?? \"CLR\"}, vis ${weather.visibility}SM.`\n        });\n    }\n    // Pilot Experience & Proficiency\n    const isStudent = pilot.certificates.type === \"Student\";\n    const totalHours = pilot.experience?.totalHours || 0;\n    const last90Days = pilot.experience?.last90DaysHours || 0;\n    // Proficiency Check (Last 90 days)\n    if (last90Days < 3) {\n        scenarios.push({\n            title: \"Recent Proficiency Gap\",\n            probability: 30,\n            severity: \"high\",\n            description: `Pilot has only ${last90Days} hours in last 90 days. High risk of skill degradation.`\n        });\n    } else if (last90Days < 6) {\n        scenarios.push({\n            title: \"Low Proficiency\",\n            probability: 15,\n            severity: \"medium\",\n            description: `Pilot has ${last90Days} hours in last 90 days. Consider a practice flight.`\n        });\n    }\n    // AI Safety Analysis Integration\n    if (pilot.safetyAnalysis && pilot.safetyAnalysis.score > 5) {\n        const aiScore = pilot.safetyAnalysis.score;\n        scenarios.push({\n            title: \"Historical Safety Risk\",\n            probability: aiScore * 5,\n            severity: aiScore > 8 ? \"critical\" : \"high\",\n            description: `AI Safety Analysis historically scores this pilot at ${aiScore}/10 risk level.`\n        });\n    }\n    if (isStudent || totalHours < 100) {\n        const expRisk = isStudent ? 25 : Math.max(15 - totalHours / 10, 5);\n        let expSeverity = \"medium\";\n        if (isStudent && isNightFlight) expSeverity = \"critical\";\n        scenarios.push({\n            title: \"Pilot Inexperience\",\n            probability: Math.round(expRisk),\n            severity: expSeverity,\n            description: isStudent ? `Student pilot with ${totalHours} total hours. ${isNightFlight ? \"NIGHT FLIGHT - requires endorsement.\" : \"\"}` : `Low-time pilot (${totalHours} hrs). Consider additional pre-flight briefing.`\n        });\n    }\n    // Engine\n    const engineHours = airframeHours % 2000;\n    const engineRisk = Math.min(Math.round(engineHours / 2000 * 10), 10);\n    scenarios.push({\n        title: \"Engine Failure\",\n        probability: engineRisk,\n        severity: engineRisk > 5 ? \"medium\" : \"low\",\n        description: `${engineRisk}% risk based on TBO position. ${engineHours.toFixed(0)} hrs since major overhaul.`\n    });\n    return scenarios.sort((a, b)=>{\n        const severityOrder = {\n            critical: 0,\n            high: 1,\n            medium: 2,\n            low: 3\n        };\n        return severityOrder[a.severity] - severityOrder[b.severity];\n    });\n}\n// Standalone audit for screenshot-parsed data (no flightId yet)\nfunction runOfflineAudit(aircraft, pilot, scheduledDate, weather) {\n    const checks = [];\n    // Maintenance checks\n    checks.push(checkAnnualInspection(aircraft, scheduledDate));\n    checks.push(checkTransponder(aircraft, scheduledDate));\n    checks.push(checkStaticSystem(aircraft, scheduledDate, pilot.certificates?.instrumentRated || false));\n    checks.push(checkHundredHour(aircraft, scheduledDate, false));\n    // Pilot currency checks\n    checks.push(checkMedical(pilot, scheduledDate));\n    checks.push(checkFlightReview(pilot, scheduledDate));\n    // Weather/safety checks\n    if (weather) {\n        const weatherChecks = checkWeatherVsPilot(weather.flightCategory, weather.wind, pilot);\n        checks.push(...weatherChecks);\n    }\n    const overallStatus = calculateOverallStatus(checks);\n    const summary = generateSummary(checks, overallStatus);\n    const riskScenarios = calculateRiskScenarios(aircraft, pilot, weather ? {\n        ...weather,\n        station: \"\",\n        metar: \"\",\n        visibility: 10,\n        fetchedAt: new Date()\n    } : undefined, scheduledDate);\n    return {\n        overallStatus,\n        checks,\n        summary,\n        riskScenarios\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGlCQUFpQnJCLFVBQVUwRjtJQUN2QzdCLE9BQU9HLElBQUksQ0FBQ3JDLGtCQUFrQjNCLFVBQVUwRixlQUFleEMsTUFBTVksWUFBWSxFQUFFQyxtQkFBbUI7SUFDOUZGLE9BQU9HLElBQUksQ0FBQ2pDLGlCQUFpQi9CLFVBQVUwRixlQUFlO0lBRXRELHdCQUF3QjtJQUN4QjdCLE9BQU9HLElBQUksQ0FBQ2YsYUFBYUMsT0FBT3dDO0lBQ2hDN0IsT0FBT0csSUFBSSxDQUFDVCxrQkFBa0JMLE9BQU93QztJQUVyQyx3QkFBd0I7SUFDeEIsSUFBSUMsU0FBUztRQUNULE1BQU1LLGdCQUFnQnRDLG9CQUFvQmlDLFFBQVFoQyxjQUFjLEVBQUVnQyxRQUFRL0IsSUFBSSxFQUFFVjtRQUNoRlcsT0FBT0csSUFBSSxJQUFJZ0M7SUFDbkI7SUFFQSxNQUFNcEIsZ0JBQWdCSix1QkFBdUJYO0lBQzdDLE1BQU1tQixVQUFVTCxnQkFBZ0JkLFFBQVFlO0lBQ3hDLE1BQU1xQixnQkFBZ0JDLHVCQUF1QmxHLFVBQVVrRCxPQUFPeUMsVUFBVTtRQUFFLEdBQUdBLE9BQU87UUFBRW1ELFNBQVM7UUFBSUMsT0FBTztRQUFJdEIsWUFBWTtRQUFJdUIsV0FBVyxJQUFJN0k7SUFBTyxJQUFXOEksV0FBV3ZEO0lBRTFLLE9BQU87UUFBRWQ7UUFBZWY7UUFBUW1CO1FBQVNpQjtJQUFjO0FBQzNEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXZpYXRpb24taW50ZWxsaWdlbmNlLWJyYWluLy4vbGliL3NlcnZpY2VzL2xlZ2FsaXR5U2VydmljZS50cz9lZjhiIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIExlZ2FsaXR5IFNlcnZpY2UgLSBDb3JlIGNvbXBsaWFuY2UgZW5naW5lIGZvciBmbGlnaHQgYXVkaXRzXG4vLyBEZXRlcm1pbmVzIEdvL0NhdXRpb24vTm8tR28gYmFzZWQgb24gRkFBIHJlZ3VsYXRpb25zXG5cbmltcG9ydCBGbGlnaHQsIHsgSUZsaWdodCwgSUxlZ2FsaXR5Q2hlY2ssIElXZWF0aGVyRGF0YSB9IGZyb20gJ0AvbGliL21vZGVscy9GbGlnaHQnO1xuaW1wb3J0IHsgSUFpcmNyYWZ0IH0gZnJvbSAnQC9saWIvbW9kZWxzL0FpcmNyYWZ0JztcbmltcG9ydCB7IElQaWxvdCB9IGZyb20gJ0AvbGliL21vZGVscy9QaWxvdCc7XG5pbXBvcnQgeyBmZXRjaFdlYXRoZXJEYXRhIH0gZnJvbSAnLi93ZWF0aGVyU2VydmljZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVJpc2tTY2VuYXJpbyB7XG4gICAgdGl0bGU6IHN0cmluZztcbiAgICBwcm9iYWJpbGl0eTogbnVtYmVyO1xuICAgIHNldmVyaXR5OiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHwgJ2NyaXRpY2FsJztcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEF1ZGl0UmVzdWx0IHtcbiAgICBvdmVyYWxsU3RhdHVzOiAnZ28nIHwgJ2NhdXRpb24nIHwgJ25vLWdvJztcbiAgICBjaGVja3M6IElMZWdhbGl0eUNoZWNrW107XG4gICAgc3VtbWFyeTogc3RyaW5nO1xuICAgIHJpc2tTY2VuYXJpb3M6IElSaXNrU2NlbmFyaW9bXTtcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIE1BSU5URU5BTkNFIENIRUNLU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZnVuY3Rpb24gY2hlY2tBbm51YWxJbnNwZWN0aW9uKGFpcmNyYWZ0OiBJQWlyY3JhZnQsIGFzT2Y6IERhdGUpOiBJTGVnYWxpdHlDaGVjayB7XG4gICAgY29uc3QgYW5udWFsRGF0ZSA9IG5ldyBEYXRlKGFpcmNyYWZ0Lm1haW50ZW5hbmNlRGF0ZXMuYW5udWFsKTtcbiAgICBjb25zdCBvbmVZZWFyTGF0ZXIgPSBuZXcgRGF0ZShhbm51YWxEYXRlKTtcbiAgICBvbmVZZWFyTGF0ZXIuc2V0RnVsbFllYXIob25lWWVhckxhdGVyLmdldEZ1bGxZZWFyKCkgKyAxKTtcblxuICAgIGNvbnN0IGlzT3ZlcmR1ZSA9IGFzT2YgPiBvbmVZZWFyTGF0ZXI7XG4gICAgY29uc3QgZGF5c1VudGlsRHVlID0gTWF0aC5mbG9vcigob25lWWVhckxhdGVyLmdldFRpbWUoKSAtIGFzT2YuZ2V0VGltZSgpKSAvIDg2NDAwMDAwKTtcblxuICAgIGlmIChpc092ZXJkdWUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNhdGVnb3J5OiAnbWFpbnRlbmFuY2UnLFxuICAgICAgICAgICAgaXRlbTogJ0FubnVhbCBJbnNwZWN0aW9uJyxcbiAgICAgICAgICAgIHN0YXR1czogJ2ZhaWwnLFxuICAgICAgICAgICAgbWVzc2FnZTogYEFubnVhbCBvdmVyZHVlIGJ5ICR7TWF0aC5hYnMoZGF5c1VudGlsRHVlKX0gZGF5c2AsXG4gICAgICAgICAgICBkZXRhaWxzOiBgTGFzdCBhbm51YWw6ICR7YW5udWFsRGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoKX1gLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGlmIChkYXlzVW50aWxEdWUgPD0gMzApIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNhdGVnb3J5OiAnbWFpbnRlbmFuY2UnLFxuICAgICAgICAgICAgaXRlbTogJ0FubnVhbCBJbnNwZWN0aW9uJyxcbiAgICAgICAgICAgIHN0YXR1czogJ3dhcm5pbmcnLFxuICAgICAgICAgICAgbWVzc2FnZTogYEFubnVhbCBkdWUgaW4gJHtkYXlzVW50aWxEdWV9IGRheXNgLFxuICAgICAgICAgICAgZGV0YWlsczogYER1ZSBieTogJHtvbmVZZWFyTGF0ZXIudG9Mb2NhbGVEYXRlU3RyaW5nKCl9YCxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBjYXRlZ29yeTogJ21haW50ZW5hbmNlJyxcbiAgICAgICAgaXRlbTogJ0FubnVhbCBJbnNwZWN0aW9uJyxcbiAgICAgICAgc3RhdHVzOiAncGFzcycsXG4gICAgICAgIG1lc3NhZ2U6IGBBbm51YWwgdmFsaWQgdW50aWwgJHtvbmVZZWFyTGF0ZXIudG9Mb2NhbGVEYXRlU3RyaW5nKCl9YCxcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBjaGVja1RyYW5zcG9uZGVyKGFpcmNyYWZ0OiBJQWlyY3JhZnQsIGFzT2Y6IERhdGUpOiBJTGVnYWxpdHlDaGVjayB7XG4gICAgY29uc3QgdHJhbnNwb25kZXJEYXRlID0gbmV3IERhdGUoYWlyY3JhZnQubWFpbnRlbmFuY2VEYXRlcy50cmFuc3BvbmRlcik7XG4gICAgY29uc3QgdHdvWWVhcnNMYXRlciA9IG5ldyBEYXRlKHRyYW5zcG9uZGVyRGF0ZSk7XG4gICAgdHdvWWVhcnNMYXRlci5zZXRNb250aCh0d29ZZWFyc0xhdGVyLmdldE1vbnRoKCkgKyAyNCk7XG5cbiAgICBjb25zdCBpc092ZXJkdWUgPSBhc09mID4gdHdvWWVhcnNMYXRlcjtcbiAgICBjb25zdCBkYXlzVW50aWxEdWUgPSBNYXRoLmZsb29yKCh0d29ZZWFyc0xhdGVyLmdldFRpbWUoKSAtIGFzT2YuZ2V0VGltZSgpKSAvIDg2NDAwMDAwKTtcblxuICAgIGlmIChpc092ZXJkdWUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNhdGVnb3J5OiAnbWFpbnRlbmFuY2UnLFxuICAgICAgICAgICAgaXRlbTogJ1RyYW5zcG9uZGVyIENoZWNrJyxcbiAgICAgICAgICAgIHN0YXR1czogJ2ZhaWwnLFxuICAgICAgICAgICAgbWVzc2FnZTogYFRyYW5zcG9uZGVyIGNoZWNrIG92ZXJkdWUgYnkgJHtNYXRoLmFicyhkYXlzVW50aWxEdWUpfSBkYXlzYCxcbiAgICAgICAgICAgIGRldGFpbHM6IGBMYXN0IGNoZWNrOiAke3RyYW5zcG9uZGVyRGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoKX1gLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGlmIChkYXlzVW50aWxEdWUgPD0gNjApIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNhdGVnb3J5OiAnbWFpbnRlbmFuY2UnLFxuICAgICAgICAgICAgaXRlbTogJ1RyYW5zcG9uZGVyIENoZWNrJyxcbiAgICAgICAgICAgIHN0YXR1czogJ3dhcm5pbmcnLFxuICAgICAgICAgICAgbWVzc2FnZTogYFRyYW5zcG9uZGVyIGR1ZSBpbiAke2RheXNVbnRpbER1ZX0gZGF5c2AsXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgY2F0ZWdvcnk6ICdtYWludGVuYW5jZScsXG4gICAgICAgIGl0ZW06ICdUcmFuc3BvbmRlciBDaGVjaycsXG4gICAgICAgIHN0YXR1czogJ3Bhc3MnLFxuICAgICAgICBtZXNzYWdlOiBgVHJhbnNwb25kZXIgdmFsaWQgdW50aWwgJHt0d29ZZWFyc0xhdGVyLnRvTG9jYWxlRGF0ZVN0cmluZygpfWAsXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gY2hlY2tTdGF0aWNTeXN0ZW0oYWlyY3JhZnQ6IElBaXJjcmFmdCwgYXNPZjogRGF0ZSwgaXNJRlI6IGJvb2xlYW4pOiBJTGVnYWxpdHlDaGVjayB7XG4gICAgaWYgKCFpc0lGUikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2F0ZWdvcnk6ICdtYWludGVuYW5jZScsXG4gICAgICAgICAgICBpdGVtOiAnU3RhdGljIFN5c3RlbSAoSUZSKScsXG4gICAgICAgICAgICBzdGF0dXM6ICdwYXNzJyxcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdOL0EgZm9yIFZGUiBmbGlnaHQnLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGNvbnN0IHN0YXRpY0RhdGUgPSBuZXcgRGF0ZShhaXJjcmFmdC5tYWludGVuYW5jZURhdGVzLnN0YXRpY1N5c3RlbSk7XG4gICAgY29uc3QgdHdvWWVhcnNMYXRlciA9IG5ldyBEYXRlKHN0YXRpY0RhdGUpO1xuICAgIHR3b1llYXJzTGF0ZXIuc2V0TW9udGgodHdvWWVhcnNMYXRlci5nZXRNb250aCgpICsgMjQpO1xuXG4gICAgY29uc3QgaXNPdmVyZHVlID0gYXNPZiA+IHR3b1llYXJzTGF0ZXI7XG4gICAgY29uc3QgZGF5c1VudGlsRHVlID0gTWF0aC5mbG9vcigodHdvWWVhcnNMYXRlci5nZXRUaW1lKCkgLSBhc09mLmdldFRpbWUoKSkgLyA4NjQwMDAwMCk7XG5cbiAgICBpZiAoaXNPdmVyZHVlKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjYXRlZ29yeTogJ21haW50ZW5hbmNlJyxcbiAgICAgICAgICAgIGl0ZW06ICdTdGF0aWMgU3lzdGVtIChJRlIpJyxcbiAgICAgICAgICAgIHN0YXR1czogJ2ZhaWwnLFxuICAgICAgICAgICAgbWVzc2FnZTogYFN0YXRpYyBzeXN0ZW0gY2hlY2sgb3ZlcmR1ZSBmb3IgSUZSYCxcbiAgICAgICAgICAgIGRldGFpbHM6IGBMYXN0IGNoZWNrOiAke3N0YXRpY0RhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKCl9YCxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBjYXRlZ29yeTogJ21haW50ZW5hbmNlJyxcbiAgICAgICAgaXRlbTogJ1N0YXRpYyBTeXN0ZW0gKElGUiknLFxuICAgICAgICBzdGF0dXM6ICdwYXNzJyxcbiAgICAgICAgbWVzc2FnZTogYFN0YXRpYyBzeXN0ZW0gdmFsaWQgdW50aWwgJHt0d29ZZWFyc0xhdGVyLnRvTG9jYWxlRGF0ZVN0cmluZygpfWAsXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gY2hlY2tIdW5kcmVkSG91cihhaXJjcmFmdDogSUFpcmNyYWZ0LCBhc09mOiBEYXRlLCBpc0ZvckhpcmU6IGJvb2xlYW4pOiBJTGVnYWxpdHlDaGVjayB7XG4gICAgaWYgKCFpc0ZvckhpcmUgfHwgIWFpcmNyYWZ0Lm1haW50ZW5hbmNlRGF0ZXMuaHVuZHJlZEhvdXIpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNhdGVnb3J5OiAnbWFpbnRlbmFuY2UnLFxuICAgICAgICAgICAgaXRlbTogJzEwMC1Ib3VyIEluc3BlY3Rpb24nLFxuICAgICAgICAgICAgc3RhdHVzOiAncGFzcycsXG4gICAgICAgICAgICBtZXNzYWdlOiAnTi9BIChub3QgZm9yLWhpcmUpJyxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBGaW5kIGxhc3QgMTAwLWhvdXIgZnJvbSBsb2dzIG9yIG1haW50ZW5hbmNlRGF0ZXNcbiAgICBjb25zdCBsYXN0SHVuZHJlZEhvdXIgPSBhaXJjcmFmdC5tYWludGVuYW5jZURhdGVzLmh1bmRyZWRIb3VyO1xuICAgIGNvbnN0IGxhc3RMb2cgPSBhaXJjcmFmdC5sb2dzPy5maW5kKGwgPT4gbC5kZXNjcmlwdGlvbi50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCcxMDAnKSk7XG4gICAgY29uc3QgbGFzdFRhY2hBdEh1bmRyZWQgPSBsYXN0TG9nPy50YWNoVGltZSB8fCAwO1xuICAgIGNvbnN0IGN1cnJlbnRUYWNoID0gYWlyY3JhZnQuY3VycmVudEhvdXJzLnRhY2g7XG4gICAgY29uc3QgaG91cnNTaW5jZSA9IGN1cnJlbnRUYWNoIC0gbGFzdFRhY2hBdEh1bmRyZWQ7XG5cbiAgICBpZiAoaG91cnNTaW5jZSA+PSAxMDApIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNhdGVnb3J5OiAnbWFpbnRlbmFuY2UnLFxuICAgICAgICAgICAgaXRlbTogJzEwMC1Ib3VyIEluc3BlY3Rpb24nLFxuICAgICAgICAgICAgc3RhdHVzOiAnZmFpbCcsXG4gICAgICAgICAgICBtZXNzYWdlOiBgMTAwLWhvdXIgb3ZlcmR1ZSBieSAkeyhob3Vyc1NpbmNlIC0gMTAwKS50b0ZpeGVkKDEpfSBob3Vyc2AsXG4gICAgICAgICAgICBkZXRhaWxzOiBgQ3VycmVudCB0YWNoOiAke2N1cnJlbnRUYWNofSwgTGFzdCAxMDAtaHIgYXQ6ICR7bGFzdFRhY2hBdEh1bmRyZWR9YCxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBpZiAoaG91cnNTaW5jZSA+PSA5MCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2F0ZWdvcnk6ICdtYWludGVuYW5jZScsXG4gICAgICAgICAgICBpdGVtOiAnMTAwLUhvdXIgSW5zcGVjdGlvbicsXG4gICAgICAgICAgICBzdGF0dXM6ICd3YXJuaW5nJyxcbiAgICAgICAgICAgIG1lc3NhZ2U6IGAxMDAtaG91ciBkdWUgaW4gJHsoMTAwIC0gaG91cnNTaW5jZSkudG9GaXhlZCgxKX0gaG91cnNgLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIGNhdGVnb3J5OiAnbWFpbnRlbmFuY2UnLFxuICAgICAgICBpdGVtOiAnMTAwLUhvdXIgSW5zcGVjdGlvbicsXG4gICAgICAgIHN0YXR1czogJ3Bhc3MnLFxuICAgICAgICBtZXNzYWdlOiBgMTAwLWhvdXIgbm90IGR1ZSBmb3IgJHsoMTAwIC0gaG91cnNTaW5jZSkudG9GaXhlZCgxKX0gbW9yZSBob3Vyc2AsXG4gICAgfTtcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBJTE9UIENVUlJFTkNZIENIRUNLU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZnVuY3Rpb24gY2hlY2tNZWRpY2FsKHBpbG90OiBJUGlsb3QsIGFzT2Y6IERhdGUpOiBJTGVnYWxpdHlDaGVjayB7XG4gICAgY29uc3QgbWVkaWNhbEV4cCA9IG5ldyBEYXRlKHBpbG90Lm1lZGljYWxFeHBpcmF0aW9uKTtcbiAgICBjb25zdCBpc0V4cGlyZWQgPSBhc09mID4gbWVkaWNhbEV4cDtcbiAgICBjb25zdCBkYXlzVW50aWxFeHAgPSBNYXRoLmZsb29yKChtZWRpY2FsRXhwLmdldFRpbWUoKSAtIGFzT2YuZ2V0VGltZSgpKSAvIDg2NDAwMDAwKTtcblxuICAgIGlmIChpc0V4cGlyZWQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNhdGVnb3J5OiAncGlsb3QnLFxuICAgICAgICAgICAgaXRlbTogJ01lZGljYWwgQ2VydGlmaWNhdGUnLFxuICAgICAgICAgICAgc3RhdHVzOiAnZmFpbCcsXG4gICAgICAgICAgICBtZXNzYWdlOiBgTWVkaWNhbCBleHBpcmVkIG9uICR7bWVkaWNhbEV4cC50b0xvY2FsZURhdGVTdHJpbmcoKX1gLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGlmIChkYXlzVW50aWxFeHAgPD0gMzApIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNhdGVnb3J5OiAncGlsb3QnLFxuICAgICAgICAgICAgaXRlbTogJ01lZGljYWwgQ2VydGlmaWNhdGUnLFxuICAgICAgICAgICAgc3RhdHVzOiAnd2FybmluZycsXG4gICAgICAgICAgICBtZXNzYWdlOiBgTWVkaWNhbCBleHBpcmVzIGluICR7ZGF5c1VudGlsRXhwfSBkYXlzYCxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBjYXRlZ29yeTogJ3BpbG90JyxcbiAgICAgICAgaXRlbTogJ01lZGljYWwgQ2VydGlmaWNhdGUnLFxuICAgICAgICBzdGF0dXM6ICdwYXNzJyxcbiAgICAgICAgbWVzc2FnZTogYE1lZGljYWwgdmFsaWQgdW50aWwgJHttZWRpY2FsRXhwLnRvTG9jYWxlRGF0ZVN0cmluZygpfWAsXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gY2hlY2tGbGlnaHRSZXZpZXcocGlsb3Q6IElQaWxvdCwgYXNPZjogRGF0ZSk6IElMZWdhbGl0eUNoZWNrIHtcbiAgICBjb25zdCBiZnJFeHAgPSBuZXcgRGF0ZShwaWxvdC5mbGlnaHRSZXZpZXdFeHBpcmF0aW9uKTtcbiAgICBjb25zdCBpc0V4cGlyZWQgPSBhc09mID4gYmZyRXhwO1xuICAgIGNvbnN0IGRheXNVbnRpbEV4cCA9IE1hdGguZmxvb3IoKGJmckV4cC5nZXRUaW1lKCkgLSBhc09mLmdldFRpbWUoKSkgLyA4NjQwMDAwMCk7XG5cbiAgICBpZiAoaXNFeHBpcmVkKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjYXRlZ29yeTogJ3BpbG90JyxcbiAgICAgICAgICAgIGl0ZW06ICdGbGlnaHQgUmV2aWV3IChCRlIpJyxcbiAgICAgICAgICAgIHN0YXR1czogJ2ZhaWwnLFxuICAgICAgICAgICAgbWVzc2FnZTogYEZsaWdodCByZXZpZXcgZXhwaXJlZCBvbiAke2JmckV4cC50b0xvY2FsZURhdGVTdHJpbmcoKX1gLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGlmIChkYXlzVW50aWxFeHAgPD0gMzApIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNhdGVnb3J5OiAncGlsb3QnLFxuICAgICAgICAgICAgaXRlbTogJ0ZsaWdodCBSZXZpZXcgKEJGUiknLFxuICAgICAgICAgICAgc3RhdHVzOiAnd2FybmluZycsXG4gICAgICAgICAgICBtZXNzYWdlOiBgRmxpZ2h0IHJldmlldyBleHBpcmVzIGluICR7ZGF5c1VudGlsRXhwfSBkYXlzYCxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBjYXRlZ29yeTogJ3BpbG90JyxcbiAgICAgICAgaXRlbTogJ0ZsaWdodCBSZXZpZXcgKEJGUiknLFxuICAgICAgICBzdGF0dXM6ICdwYXNzJyxcbiAgICAgICAgbWVzc2FnZTogYEZsaWdodCByZXZpZXcgdmFsaWQgdW50aWwgJHtiZnJFeHAudG9Mb2NhbGVEYXRlU3RyaW5nKCl9YCxcbiAgICB9O1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gV0VBVEhFUiAvIFNBRkVUWSBDSEVDS1Ncbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmZ1bmN0aW9uIGNoZWNrV2VhdGhlclZzUGlsb3QoXG4gICAgZmxpZ2h0Q2F0ZWdvcnk6ICdWRlInIHwgJ01WRlInIHwgJ0lGUicgfCAnTElGUicsXG4gICAgd2luZDogeyBzcGVlZDogbnVtYmVyOyBndXN0PzogbnVtYmVyIH0sXG4gICAgcGlsb3Q6IElQaWxvdFxuKTogSUxlZ2FsaXR5Q2hlY2tbXSB7XG4gICAgY29uc3QgY2hlY2tzOiBJTGVnYWxpdHlDaGVja1tdID0gW107XG5cbiAgICAvLyBJRlIvTElGUiBjb25kaXRpb25zIGNoZWNrXG4gICAgaWYgKChmbGlnaHRDYXRlZ29yeSA9PT0gJ0lGUicgfHwgZmxpZ2h0Q2F0ZWdvcnkgPT09ICdMSUZSJykgJiYgIXBpbG90LmNlcnRpZmljYXRlcy5pbnN0cnVtZW50UmF0ZWQpIHtcbiAgICAgICAgY2hlY2tzLnB1c2goe1xuICAgICAgICAgICAgY2F0ZWdvcnk6ICdzYWZldHknLFxuICAgICAgICAgICAgaXRlbTogJ1dlYXRoZXIgdnMuIFJhdGluZ3MnLFxuICAgICAgICAgICAgc3RhdHVzOiAnZmFpbCcsXG4gICAgICAgICAgICBtZXNzYWdlOiBgJHtmbGlnaHRDYXRlZ29yeX0gY29uZGl0aW9ucyByZXF1aXJlIGluc3RydW1lbnQgcmF0aW5nYCxcbiAgICAgICAgICAgIGRldGFpbHM6IGBQaWxvdCAke3BpbG90Lm5hbWV9IGlzIFZGUi1vbmx5YCxcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChmbGlnaHRDYXRlZ29yeSA9PT0gJ01WRlInICYmIChwaWxvdC5leHBlcmllbmNlPy50b3RhbEhvdXJzIHx8IDApIDwgMTAwKSB7XG4gICAgICAgIGNoZWNrcy5wdXNoKHtcbiAgICAgICAgICAgIGNhdGVnb3J5OiAnc2FmZXR5JyxcbiAgICAgICAgICAgIGl0ZW06ICdXZWF0aGVyIHZzLiBFeHBlcmllbmNlJyxcbiAgICAgICAgICAgIHN0YXR1czogJ3dhcm5pbmcnLFxuICAgICAgICAgICAgbWVzc2FnZTogJ01WRlIgY29uZGl0aW9ucyBub3QgcmVjb21tZW5kZWQgZm9yIGxvdy10aW1lIHBpbG90cycsXG4gICAgICAgICAgICBkZXRhaWxzOiBgUGlsb3QgaGFzICR7cGlsb3QuZXhwZXJpZW5jZT8udG90YWxIb3VycyB8fCAwfSB0b3RhbCBob3Vyc2AsXG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNoZWNrcy5wdXNoKHtcbiAgICAgICAgICAgIGNhdGVnb3J5OiAnc2FmZXR5JyxcbiAgICAgICAgICAgIGl0ZW06ICdXZWF0aGVyIHZzLiBSYXRpbmdzJyxcbiAgICAgICAgICAgIHN0YXR1czogJ3Bhc3MnLFxuICAgICAgICAgICAgbWVzc2FnZTogYCR7ZmxpZ2h0Q2F0ZWdvcnl9IGNvbmRpdGlvbnMgT0sgZm9yIHBpbG90IHF1YWxpZmljYXRpb25zYCxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gV2luZCBjaGVja3NcbiAgICBjb25zdCBtYXhXaW5kID0gTWF0aC5tYXgod2luZC5zcGVlZCwgd2luZC5ndXN0IHx8IDApO1xuICAgIGlmIChtYXhXaW5kID49IDMwKSB7XG4gICAgICAgIGNoZWNrcy5wdXNoKHtcbiAgICAgICAgICAgIGNhdGVnb3J5OiAnc2FmZXR5JyxcbiAgICAgICAgICAgIGl0ZW06ICdXaW5kIENvbmRpdGlvbnMnLFxuICAgICAgICAgICAgc3RhdHVzOiAnZmFpbCcsXG4gICAgICAgICAgICBtZXNzYWdlOiBgRXhjZXNzaXZlIHdpbmRzOiAke3dpbmQuc3BlZWR9a3RzJHt3aW5kLmd1c3QgPyBgIGd1c3RpbmcgJHt3aW5kLmd1c3R9a3RzYCA6ICcnfWAsXG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAobWF4V2luZCA+PSAyMCkge1xuICAgICAgICBjaGVja3MucHVzaCh7XG4gICAgICAgICAgICBjYXRlZ29yeTogJ3NhZmV0eScsXG4gICAgICAgICAgICBpdGVtOiAnV2luZCBDb25kaXRpb25zJyxcbiAgICAgICAgICAgIHN0YXR1czogJ3dhcm5pbmcnLFxuICAgICAgICAgICAgbWVzc2FnZTogYEhpZ2ggd2luZHM6ICR7d2luZC5zcGVlZH1rdHMke3dpbmQuZ3VzdCA/IGAgZ3VzdGluZyAke3dpbmQuZ3VzdH1rdHNgIDogJyd9YCxcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY2hlY2tzLnB1c2goe1xuICAgICAgICAgICAgY2F0ZWdvcnk6ICdzYWZldHknLFxuICAgICAgICAgICAgaXRlbTogJ1dpbmQgQ29uZGl0aW9ucycsXG4gICAgICAgICAgICBzdGF0dXM6ICdwYXNzJyxcbiAgICAgICAgICAgIG1lc3NhZ2U6IGBXaW5kcyBhY2NlcHRhYmxlOiAke3dpbmQuc3BlZWR9a3RzYCxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNoZWNrcztcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIE9WRVJBTEwgU1RBVFVTIENBTENVTEFUSU9OXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5mdW5jdGlvbiBjYWxjdWxhdGVPdmVyYWxsU3RhdHVzKGNoZWNrczogSUxlZ2FsaXR5Q2hlY2tbXSk6ICdnbycgfCAnY2F1dGlvbicgfCAnbm8tZ28nIHtcbiAgICBpZiAoY2hlY2tzLnNvbWUoYyA9PiBjLnN0YXR1cyA9PT0gJ2ZhaWwnKSkgcmV0dXJuICduby1nbyc7XG4gICAgaWYgKGNoZWNrcy5zb21lKGMgPT4gYy5zdGF0dXMgPT09ICd3YXJuaW5nJykpIHJldHVybiAnY2F1dGlvbic7XG4gICAgcmV0dXJuICdnbyc7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlU3VtbWFyeShjaGVja3M6IElMZWdhbGl0eUNoZWNrW10sIG92ZXJhbGxTdGF0dXM6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgZmFpbGVkQ2hlY2tzID0gY2hlY2tzLmZpbHRlcihjID0+IGMuc3RhdHVzID09PSAnZmFpbCcpO1xuICAgIGNvbnN0IHdhcm5pbmdzID0gY2hlY2tzLmZpbHRlcihjID0+IGMuc3RhdHVzID09PSAnd2FybmluZycpO1xuXG4gICAgaWYgKG92ZXJhbGxTdGF0dXMgPT09ICdnbycpIHtcbiAgICAgICAgcmV0dXJuICfinIUgQWxsIHN5c3RlbXMgR08uIEZsaWdodCBpcyBsZWdhbCBhbmQgc2FmZSB0byBvcGVyYXRlLic7XG4gICAgfVxuXG4gICAgbGV0IHN1bW1hcnkgPSBvdmVyYWxsU3RhdHVzID09PSAnbm8tZ28nID8gJ/Cfm5EgRkxJR0hUIEdST1VOREVEXFxuXFxuJyA6ICfimqDvuI8gRkxJR0hUIENBVVRJT05cXG5cXG4nO1xuXG4gICAgaWYgKGZhaWxlZENoZWNrcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHN1bW1hcnkgKz0gJ0NyaXRpY2FsIElzc3VlczpcXG4nO1xuICAgICAgICBmYWlsZWRDaGVja3MuZm9yRWFjaChjID0+IHtcbiAgICAgICAgICAgIHN1bW1hcnkgKz0gYOKAoiAke2MuaXRlbX06ICR7Yy5tZXNzYWdlfVxcbmA7XG4gICAgICAgIH0pO1xuICAgICAgICBzdW1tYXJ5ICs9ICdcXG4nO1xuICAgIH1cblxuICAgIGlmICh3YXJuaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHN1bW1hcnkgKz0gJ1dhcm5pbmdzOlxcbic7XG4gICAgICAgIHdhcm5pbmdzLmZvckVhY2goYyA9PiB7XG4gICAgICAgICAgICBzdW1tYXJ5ICs9IGDigKIgJHtjLml0ZW19OiAke2MubWVzc2FnZX1cXG5gO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gc3VtbWFyeTtcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIE1BSU4gQVVESVQgRlVOQ1RJT05cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBydW5MZWdhbGl0eUF1ZGl0KGZsaWdodElkOiBzdHJpbmcpOiBQcm9taXNlPEF1ZGl0UmVzdWx0PiB7XG4gICAgLy8gMS4gRmV0Y2ggZmxpZ2h0IHdpdGggcG9wdWxhdGVkIHBpbG90ICYgYWlyY3JhZnRcbiAgICBjb25zdCBmbGlnaHQgPSBhd2FpdCBGbGlnaHQuZmluZEJ5SWQoZmxpZ2h0SWQpXG4gICAgICAgIC5wb3B1bGF0ZSgncGlsb3QnKVxuICAgICAgICAucG9wdWxhdGUoJ2FpcmNyYWZ0JylcbiAgICAgICAgLmV4ZWMoKTtcblxuICAgIGlmICghZmxpZ2h0KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRmxpZ2h0IG5vdCBmb3VuZDogJHtmbGlnaHRJZH1gKTtcbiAgICB9XG5cbiAgICBjb25zdCBwaWxvdCA9IGZsaWdodC5waWxvdCBhcyB1bmtub3duIGFzIElQaWxvdDtcbiAgICBjb25zdCBhaXJjcmFmdCA9IGZsaWdodC5haXJjcmFmdCBhcyB1bmtub3duIGFzIElBaXJjcmFmdDtcbiAgICBjb25zdCBzY2hlZHVsZWREYXRlID0gbmV3IERhdGUoZmxpZ2h0LnNjaGVkdWxlZERhdGUpO1xuXG4gICAgaWYgKCFwaWxvdCB8fCAhYWlyY3JhZnQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGbGlnaHQgbWlzc2luZyBwaWxvdCBvciBhaXJjcmFmdCByZWZlcmVuY2UnKTtcbiAgICB9XG5cbiAgICAvLyAyLiBGZXRjaCBsaXZlIHdlYXRoZXJcbiAgICBsZXQgd2VhdGhlciA9IGZsaWdodC53ZWF0aGVyO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGZldGNoZWRXZWF0aGVyID0gYXdhaXQgZmV0Y2hXZWF0aGVyRGF0YShmbGlnaHQuZGVwYXJ0dXJlQWlycG9ydCk7XG4gICAgICAgIGlmIChmZXRjaGVkV2VhdGhlcikge1xuICAgICAgICAgICAgd2VhdGhlciA9IGZldGNoZWRXZWF0aGVyO1xuICAgICAgICB9XG4gICAgfSBjYXRjaCB7XG4gICAgICAgIGNvbnNvbGUud2FybignV2VhdGhlciBmZXRjaCBmYWlsZWQsIHVzaW5nIGNhY2hlZCBvciBkZWZhdWx0cycpO1xuICAgIH1cblxuICAgIC8vIDMuIFJ1biBhbGwgY2hlY2tzXG4gICAgY29uc3QgY2hlY2tzOiBJTGVnYWxpdHlDaGVja1tdID0gW107XG5cbiAgICAvLyBNYWludGVuYW5jZSBjaGVja3NcbiAgICBjaGVja3MucHVzaChjaGVja0FubnVhbEluc3BlY3Rpb24oYWlyY3JhZnQsIHNjaGVkdWxlZERhdGUpKTtcbiAgICBjaGVja3MucHVzaChjaGVja1RyYW5zcG9uZGVyKGFpcmNyYWZ0LCBzY2hlZHVsZWREYXRlKSk7XG4gICAgY2hlY2tzLnB1c2goY2hlY2tTdGF0aWNTeXN0ZW0oYWlyY3JhZnQsIHNjaGVkdWxlZERhdGUsIHBpbG90LmNlcnRpZmljYXRlcz8uaW5zdHJ1bWVudFJhdGVkIHx8IGZhbHNlKSk7XG4gICAgY2hlY2tzLnB1c2goY2hlY2tIdW5kcmVkSG91cihhaXJjcmFmdCwgc2NoZWR1bGVkRGF0ZSwgZmFsc2UpKTsgLy8gQXNzdW1lIG5vdCBmb3ItaGlyZSBmb3IgZGVtb1xuXG4gICAgLy8gUGlsb3QgY3VycmVuY3kgY2hlY2tzXG4gICAgY2hlY2tzLnB1c2goY2hlY2tNZWRpY2FsKHBpbG90LCBzY2hlZHVsZWREYXRlKSk7XG4gICAgY2hlY2tzLnB1c2goY2hlY2tGbGlnaHRSZXZpZXcocGlsb3QsIHNjaGVkdWxlZERhdGUpKTtcblxuICAgIC8vIFdlYXRoZXIvc2FmZXR5IGNoZWNrc1xuICAgIGlmICh3ZWF0aGVyKSB7XG4gICAgICAgIGNvbnN0IHdlYXRoZXJDaGVja3MgPSBjaGVja1dlYXRoZXJWc1BpbG90KFxuICAgICAgICAgICAgd2VhdGhlci5mbGlnaHRDYXRlZ29yeSxcbiAgICAgICAgICAgIHdlYXRoZXIud2luZCxcbiAgICAgICAgICAgIHBpbG90XG4gICAgICAgICk7XG4gICAgICAgIGNoZWNrcy5wdXNoKC4uLndlYXRoZXJDaGVja3MpO1xuICAgIH1cblxuICAgIC8vIDQuIENhbGN1bGF0ZSBvdmVyYWxsIHN0YXR1c1xuICAgIGNvbnN0IG92ZXJhbGxTdGF0dXMgPSBjYWxjdWxhdGVPdmVyYWxsU3RhdHVzKGNoZWNrcyk7XG4gICAgY29uc3Qgc3VtbWFyeSA9IGdlbmVyYXRlU3VtbWFyeShjaGVja3MsIG92ZXJhbGxTdGF0dXMpO1xuICAgIGNvbnN0IHJpc2tTY2VuYXJpb3MgPSBjYWxjdWxhdGVSaXNrU2NlbmFyaW9zKGFpcmNyYWZ0LCBwaWxvdCwgd2VhdGhlciwgc2NoZWR1bGVkRGF0ZSk7XG5cbiAgICAvLyA1LiBVcGRhdGUgZmxpZ2h0IGRvY3VtZW50XG4gICAgZmxpZ2h0LmxlZ2FsaXR5Q2hlY2tzID0gY2hlY2tzO1xuICAgIGZsaWdodC5vdmVyYWxsU3RhdHVzID0gb3ZlcmFsbFN0YXR1cztcbiAgICBpZiAod2VhdGhlcikgZmxpZ2h0LndlYXRoZXIgPSB3ZWF0aGVyO1xuXG4gICAgLy8gU0FWRSBTTkFQU0hPVFxuICAgIGZsaWdodC5zYWZldHlBbmFseXNpc1NuYXBzaG90ID0ge1xuICAgICAgICBjaGVja3MsXG4gICAgICAgIG92ZXJhbGxTdGF0dXMsXG4gICAgICAgIHdlYXRoZXIsXG4gICAgICAgIHJpc2tTY2VuYXJpb3MsXG4gICAgICAgIGdlbmVyYXRlZEF0OiBuZXcgRGF0ZSgpXG4gICAgfTtcblxuICAgIGF3YWl0IGZsaWdodC5zYXZlKCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBvdmVyYWxsU3RhdHVzLFxuICAgICAgICBjaGVja3MsXG4gICAgICAgIHN1bW1hcnksXG4gICAgICAgIHJpc2tTY2VuYXJpb3NcbiAgICB9O1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUklTSyBTQ0VOQVJJTyBDQUxDVUxBVElPTlxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZnVuY3Rpb24gY2FsY3VsYXRlUmlza1NjZW5hcmlvcyhhaXJjcmFmdDogSUFpcmNyYWZ0LCBwaWxvdDogSVBpbG90LCB3ZWF0aGVyOiBJV2VhdGhlckRhdGEgfCB1bmRlZmluZWQsIHNjaGVkdWxlZERhdGU6IERhdGUpOiBJUmlza1NjZW5hcmlvW10ge1xuICAgIGNvbnN0IHNjZW5hcmlvczogSVJpc2tTY2VuYXJpb1tdID0gW107XG4gICAgY29uc3QgaG91ciA9IHNjaGVkdWxlZERhdGUuZ2V0SG91cnMoKTtcbiAgICBjb25zdCBpc05pZ2h0RmxpZ2h0ID0gaG91ciA+PSAxOSB8fCBob3VyIDw9IDY7XG4gICAgY29uc3QgYWlyZnJhbWVIb3VycyA9IGFpcmNyYWZ0LmN1cnJlbnRIb3Vycy5ob2JicyB8fCAwO1xuXG4gICAgLy8gQWx0ZXJuYXRvclxuICAgIGNvbnN0IGFsdGVybmF0b3JSaXNrID0gTWF0aC5taW4oTWF0aC5yb3VuZCgoYWlyZnJhbWVIb3VycyAlIDUwMCkgLyA1MDAgKiAxNSksIDE1KTtcbiAgICBsZXQgYWx0ZXJuYXRvclNldmVyaXR5OiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHwgJ2NyaXRpY2FsJyA9ICdsb3cnO1xuICAgIGlmIChpc05pZ2h0RmxpZ2h0ICYmIGFsdGVybmF0b3JSaXNrID4gNSkgYWx0ZXJuYXRvclNldmVyaXR5ID0gJ2hpZ2gnO1xuICAgIGlmIChpc05pZ2h0RmxpZ2h0ICYmIChwaWxvdC5leHBlcmllbmNlPy5uaWdodEhvdXJzIHx8IDApIDwgMjApIGFsdGVybmF0b3JTZXZlcml0eSA9ICdjcml0aWNhbCc7XG5cbiAgICBzY2VuYXJpb3MucHVzaCh7XG4gICAgICAgIHRpdGxlOiAnRWxlY3RyaWNhbCBGYWlsdXJlJyxcbiAgICAgICAgcHJvYmFiaWxpdHk6IGFsdGVybmF0b3JSaXNrLFxuICAgICAgICBzZXZlcml0eTogYWx0ZXJuYXRvclNldmVyaXR5LFxuICAgICAgICBkZXNjcmlwdGlvbjogaXNOaWdodEZsaWdodFxuICAgICAgICAgICAgPyBgJHthbHRlcm5hdG9yUmlza30lIGFsdGVybmF0b3IgZmFpbHVyZSByaXNrLiBOaWdodCBmbGlnaHQgd2l0aCAke3BpbG90LmV4cGVyaWVuY2U/Lm5pZ2h0SG91cnMgfHwgMH0gbmlnaHQgaG91cnMgLSBOTyBMSUdIVFMvUkFESU9TIHdvdWxkIGJlIGNhdGFzdHJvcGhpYy5gXG4gICAgICAgICAgICA6IGAke2FsdGVybmF0b3JSaXNrfSUgYWx0ZXJuYXRvciBmYWlsdXJlIHJpc2suIERheWxpZ2h0IG9wZXJhdGlvbnMgcmVkdWNlIHNldmVyaXR5LmBcbiAgICB9KTtcblxuICAgIC8vIFdlYXRoZXJcbiAgICBpZiAod2VhdGhlcikge1xuICAgICAgICBsZXQgd3hSaXNrID0gNTtcbiAgICAgICAgaWYgKHdlYXRoZXIuZmxpZ2h0Q2F0ZWdvcnkgPT09ICdNVkZSJykgd3hSaXNrID0gMjA7XG4gICAgICAgIGlmICh3ZWF0aGVyLmZsaWdodENhdGVnb3J5ID09PSAnSUZSJykgd3hSaXNrID0gNDA7XG4gICAgICAgIGlmICh3ZWF0aGVyLmZsaWdodENhdGVnb3J5ID09PSAnTElGUicpIHd4UmlzayA9IDYwO1xuXG4gICAgICAgIGNvbnN0IGlzSVJQaWxvdCA9IHBpbG90LmNlcnRpZmljYXRlcy5pbnN0cnVtZW50UmF0ZWQ7XG4gICAgICAgIGxldCB3eFNldmVyaXR5OiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHwgJ2NyaXRpY2FsJyA9ICdsb3cnO1xuICAgICAgICBpZiAod3hSaXNrID49IDIwICYmICFpc0lSUGlsb3QpIHd4U2V2ZXJpdHkgPSAnaGlnaCc7XG4gICAgICAgIGlmICh3eFJpc2sgPj0gNDAgJiYgIWlzSVJQaWxvdCkgd3hTZXZlcml0eSA9ICdjcml0aWNhbCc7XG5cbiAgICAgICAgc2NlbmFyaW9zLnB1c2goe1xuICAgICAgICAgICAgdGl0bGU6ICdXZWF0aGVyIEJlbG93IE1pbmltdW1zJyxcbiAgICAgICAgICAgIHByb2JhYmlsaXR5OiB3eFJpc2ssXG4gICAgICAgICAgICBzZXZlcml0eTogd3hTZXZlcml0eSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAhaXNJUlBpbG90ICYmIHd4UmlzayA+PSAyMFxuICAgICAgICAgICAgICAgID8gYCR7d2VhdGhlci5mbGlnaHRDYXRlZ29yeX0gY29uZGl0aW9ucyB3aXRoIFZGUi1vbmx5IHBpbG90LiBJZiB3ZWF0aGVyIHdvcnNlbnMsIHBpbG90IGxhY2tzIGluc3RydW1lbnQgY2FwYWJpbGl0eS5gXG4gICAgICAgICAgICAgICAgOiBgQ3VycmVudDogJHt3ZWF0aGVyLmZsaWdodENhdGVnb3J5fS4gQ2VpbGluZyAke3dlYXRoZXIuY2VpbGluZyA/PyAnQ0xSJ30sIHZpcyAke3dlYXRoZXIudmlzaWJpbGl0eX1TTS5gXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFBpbG90IEV4cGVyaWVuY2UgJiBQcm9maWNpZW5jeVxuICAgIGNvbnN0IGlzU3R1ZGVudCA9IHBpbG90LmNlcnRpZmljYXRlcy50eXBlID09PSAnU3R1ZGVudCc7XG4gICAgY29uc3QgdG90YWxIb3VycyA9IHBpbG90LmV4cGVyaWVuY2U/LnRvdGFsSG91cnMgfHwgMDtcbiAgICBjb25zdCBsYXN0OTBEYXlzID0gcGlsb3QuZXhwZXJpZW5jZT8ubGFzdDkwRGF5c0hvdXJzIHx8IDA7XG5cbiAgICAvLyBQcm9maWNpZW5jeSBDaGVjayAoTGFzdCA5MCBkYXlzKVxuICAgIGlmIChsYXN0OTBEYXlzIDwgMykge1xuICAgICAgICBzY2VuYXJpb3MucHVzaCh7XG4gICAgICAgICAgICB0aXRsZTogJ1JlY2VudCBQcm9maWNpZW5jeSBHYXAnLFxuICAgICAgICAgICAgcHJvYmFiaWxpdHk6IDMwLFxuICAgICAgICAgICAgc2V2ZXJpdHk6ICdoaWdoJyxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgUGlsb3QgaGFzIG9ubHkgJHtsYXN0OTBEYXlzfSBob3VycyBpbiBsYXN0IDkwIGRheXMuIEhpZ2ggcmlzayBvZiBza2lsbCBkZWdyYWRhdGlvbi5gXG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAobGFzdDkwRGF5cyA8IDYpIHtcbiAgICAgICAgc2NlbmFyaW9zLnB1c2goe1xuICAgICAgICAgICAgdGl0bGU6ICdMb3cgUHJvZmljaWVuY3knLFxuICAgICAgICAgICAgcHJvYmFiaWxpdHk6IDE1LFxuICAgICAgICAgICAgc2V2ZXJpdHk6ICdtZWRpdW0nLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IGBQaWxvdCBoYXMgJHtsYXN0OTBEYXlzfSBob3VycyBpbiBsYXN0IDkwIGRheXMuIENvbnNpZGVyIGEgcHJhY3RpY2UgZmxpZ2h0LmBcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gQUkgU2FmZXR5IEFuYWx5c2lzIEludGVncmF0aW9uXG4gICAgaWYgKHBpbG90LnNhZmV0eUFuYWx5c2lzICYmIHBpbG90LnNhZmV0eUFuYWx5c2lzLnNjb3JlID4gNSkge1xuICAgICAgICBjb25zdCBhaVNjb3JlID0gcGlsb3Quc2FmZXR5QW5hbHlzaXMuc2NvcmU7XG4gICAgICAgIHNjZW5hcmlvcy5wdXNoKHtcbiAgICAgICAgICAgIHRpdGxlOiAnSGlzdG9yaWNhbCBTYWZldHkgUmlzaycsXG4gICAgICAgICAgICBwcm9iYWJpbGl0eTogYWlTY29yZSAqIDUsXG4gICAgICAgICAgICBzZXZlcml0eTogYWlTY29yZSA+IDggPyAnY3JpdGljYWwnIDogJ2hpZ2gnLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IGBBSSBTYWZldHkgQW5hbHlzaXMgaGlzdG9yaWNhbGx5IHNjb3JlcyB0aGlzIHBpbG90IGF0ICR7YWlTY29yZX0vMTAgcmlzayBsZXZlbC5gXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChpc1N0dWRlbnQgfHwgdG90YWxIb3VycyA8IDEwMCkge1xuICAgICAgICBjb25zdCBleHBSaXNrID0gaXNTdHVkZW50ID8gMjUgOiBNYXRoLm1heCgxNSAtIHRvdGFsSG91cnMgLyAxMCwgNSk7XG4gICAgICAgIGxldCBleHBTZXZlcml0eTogJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJyB8ICdjcml0aWNhbCcgPSAnbWVkaXVtJztcbiAgICAgICAgaWYgKGlzU3R1ZGVudCAmJiBpc05pZ2h0RmxpZ2h0KSBleHBTZXZlcml0eSA9ICdjcml0aWNhbCc7XG5cbiAgICAgICAgc2NlbmFyaW9zLnB1c2goe1xuICAgICAgICAgICAgdGl0bGU6ICdQaWxvdCBJbmV4cGVyaWVuY2UnLFxuICAgICAgICAgICAgcHJvYmFiaWxpdHk6IE1hdGgucm91bmQoZXhwUmlzayksXG4gICAgICAgICAgICBzZXZlcml0eTogZXhwU2V2ZXJpdHksXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogaXNTdHVkZW50XG4gICAgICAgICAgICAgICAgPyBgU3R1ZGVudCBwaWxvdCB3aXRoICR7dG90YWxIb3Vyc30gdG90YWwgaG91cnMuICR7aXNOaWdodEZsaWdodCA/ICdOSUdIVCBGTElHSFQgLSByZXF1aXJlcyBlbmRvcnNlbWVudC4nIDogJyd9YFxuICAgICAgICAgICAgICAgIDogYExvdy10aW1lIHBpbG90ICgke3RvdGFsSG91cnN9IGhycykuIENvbnNpZGVyIGFkZGl0aW9uYWwgcHJlLWZsaWdodCBicmllZmluZy5gXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIEVuZ2luZVxuICAgIGNvbnN0IGVuZ2luZUhvdXJzID0gYWlyZnJhbWVIb3VycyAlIDIwMDA7XG4gICAgY29uc3QgZW5naW5lUmlzayA9IE1hdGgubWluKE1hdGgucm91bmQoZW5naW5lSG91cnMgLyAyMDAwICogMTApLCAxMCk7XG4gICAgc2NlbmFyaW9zLnB1c2goe1xuICAgICAgICB0aXRsZTogJ0VuZ2luZSBGYWlsdXJlJyxcbiAgICAgICAgcHJvYmFiaWxpdHk6IGVuZ2luZVJpc2ssXG4gICAgICAgIHNldmVyaXR5OiBlbmdpbmVSaXNrID4gNSA/ICdtZWRpdW0nIDogJ2xvdycsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBgJHtlbmdpbmVSaXNrfSUgcmlzayBiYXNlZCBvbiBUQk8gcG9zaXRpb24uICR7ZW5naW5lSG91cnMudG9GaXhlZCgwKX0gaHJzIHNpbmNlIG1ham9yIG92ZXJoYXVsLmBcbiAgICB9KTtcblxuICAgIHJldHVybiBzY2VuYXJpb3Muc29ydCgoYSwgYikgPT4ge1xuICAgICAgICBjb25zdCBzZXZlcml0eU9yZGVyID0geyBjcml0aWNhbDogMCwgaGlnaDogMSwgbWVkaXVtOiAyLCBsb3c6IDMgfTtcbiAgICAgICAgcmV0dXJuIHNldmVyaXR5T3JkZXJbYS5zZXZlcml0eV0gLSBzZXZlcml0eU9yZGVyW2Iuc2V2ZXJpdHldO1xuICAgIH0pO1xufVxuXG4vLyBTdGFuZGFsb25lIGF1ZGl0IGZvciBzY3JlZW5zaG90LXBhcnNlZCBkYXRhIChubyBmbGlnaHRJZCB5ZXQpXG5leHBvcnQgZnVuY3Rpb24gcnVuT2ZmbGluZUF1ZGl0KFxuICAgIGFpcmNyYWZ0OiBJQWlyY3JhZnQsXG4gICAgcGlsb3Q6IElQaWxvdCxcbiAgICBzY2hlZHVsZWREYXRlOiBEYXRlLFxuICAgIHdlYXRoZXI/OiB7IGZsaWdodENhdGVnb3J5OiAnVkZSJyB8ICdNVkZSJyB8ICdJRlInIHwgJ0xJRlInOyB3aW5kOiB7IHNwZWVkOiBudW1iZXI7IGd1c3Q/OiBudW1iZXIgfSB9XG4pOiBBdWRpdFJlc3VsdCB7XG4gICAgY29uc3QgY2hlY2tzOiBJTGVnYWxpdHlDaGVja1tdID0gW107XG5cbiAgICAvLyBNYWludGVuYW5jZSBjaGVja3NcbiAgICBjaGVja3MucHVzaChjaGVja0FubnVhbEluc3BlY3Rpb24oYWlyY3JhZnQsIHNjaGVkdWxlZERhdGUpKTtcbiAgICBjaGVja3MucHVzaChjaGVja1RyYW5zcG9uZGVyKGFpcmNyYWZ0LCBzY2hlZHVsZWREYXRlKSk7XG4gICAgY2hlY2tzLnB1c2goY2hlY2tTdGF0aWNTeXN0ZW0oYWlyY3JhZnQsIHNjaGVkdWxlZERhdGUsIHBpbG90LmNlcnRpZmljYXRlcz8uaW5zdHJ1bWVudFJhdGVkIHx8IGZhbHNlKSk7XG4gICAgY2hlY2tzLnB1c2goY2hlY2tIdW5kcmVkSG91cihhaXJjcmFmdCwgc2NoZWR1bGVkRGF0ZSwgZmFsc2UpKTtcblxuICAgIC8vIFBpbG90IGN1cnJlbmN5IGNoZWNrc1xuICAgIGNoZWNrcy5wdXNoKGNoZWNrTWVkaWNhbChwaWxvdCwgc2NoZWR1bGVkRGF0ZSkpO1xuICAgIGNoZWNrcy5wdXNoKGNoZWNrRmxpZ2h0UmV2aWV3KHBpbG90LCBzY2hlZHVsZWREYXRlKSk7XG5cbiAgICAvLyBXZWF0aGVyL3NhZmV0eSBjaGVja3NcbiAgICBpZiAod2VhdGhlcikge1xuICAgICAgICBjb25zdCB3ZWF0aGVyQ2hlY2tzID0gY2hlY2tXZWF0aGVyVnNQaWxvdCh3ZWF0aGVyLmZsaWdodENhdGVnb3J5LCB3ZWF0aGVyLndpbmQsIHBpbG90KTtcbiAgICAgICAgY2hlY2tzLnB1c2goLi4ud2VhdGhlckNoZWNrcyk7XG4gICAgfVxuXG4gICAgY29uc3Qgb3ZlcmFsbFN0YXR1cyA9IGNhbGN1bGF0ZU92ZXJhbGxTdGF0dXMoY2hlY2tzKTtcbiAgICBjb25zdCBzdW1tYXJ5ID0gZ2VuZXJhdGVTdW1tYXJ5KGNoZWNrcywgb3ZlcmFsbFN0YXR1cyk7XG4gICAgY29uc3Qgcmlza1NjZW5hcmlvcyA9IGNhbGN1bGF0ZVJpc2tTY2VuYXJpb3MoYWlyY3JhZnQsIHBpbG90LCB3ZWF0aGVyID8geyAuLi53ZWF0aGVyLCBzdGF0aW9uOiAnJywgbWV0YXI6ICcnLCB2aXNpYmlsaXR5OiAxMCwgZmV0Y2hlZEF0OiBuZXcgRGF0ZSgpIH0gYXMgYW55IDogdW5kZWZpbmVkLCBzY2hlZHVsZWREYXRlKTtcblxuICAgIHJldHVybiB7IG92ZXJhbGxTdGF0dXMsIGNoZWNrcywgc3VtbWFyeSwgcmlza1NjZW5hcmlvcyB9O1xufVxuIl0sIm5hbWVzIjpbIkZsaWdodCIsImZldGNoV2VhdGhlckRhdGEiLCJjaGVja0FubnVhbEluc3BlY3Rpb24iLCJhaXJjcmFmdCIsImFzT2YiLCJhbm51YWxEYXRlIiwiRGF0ZSIsIm1haW50ZW5hbmNlRGF0ZXMiLCJhbm51YWwiLCJvbmVZZWFyTGF0ZXIiLCJzZXRGdWxsWWVhciIsImdldEZ1bGxZZWFyIiwiaXNPdmVyZHVlIiwiZGF5c1VudGlsRHVlIiwiTWF0aCIsImZsb29yIiwiZ2V0VGltZSIsImNhdGVnb3J5IiwiaXRlbSIsInN0YXR1cyIsIm1lc3NhZ2UiLCJhYnMiLCJkZXRhaWxzIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwiY2hlY2tUcmFuc3BvbmRlciIsInRyYW5zcG9uZGVyRGF0ZSIsInRyYW5zcG9uZGVyIiwidHdvWWVhcnNMYXRlciIsInNldE1vbnRoIiwiZ2V0TW9udGgiLCJjaGVja1N0YXRpY1N5c3RlbSIsImlzSUZSIiwic3RhdGljRGF0ZSIsInN0YXRpY1N5c3RlbSIsImNoZWNrSHVuZHJlZEhvdXIiLCJpc0ZvckhpcmUiLCJodW5kcmVkSG91ciIsImxhc3RIdW5kcmVkSG91ciIsImxhc3RMb2ciLCJsb2dzIiwiZmluZCIsImwiLCJkZXNjcmlwdGlvbiIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJsYXN0VGFjaEF0SHVuZHJlZCIsInRhY2hUaW1lIiwiY3VycmVudFRhY2giLCJjdXJyZW50SG91cnMiLCJ0YWNoIiwiaG91cnNTaW5jZSIsInRvRml4ZWQiLCJjaGVja01lZGljYWwiLCJwaWxvdCIsIm1lZGljYWxFeHAiLCJtZWRpY2FsRXhwaXJhdGlvbiIsImlzRXhwaXJlZCIsImRheXNVbnRpbEV4cCIsImNoZWNrRmxpZ2h0UmV2aWV3IiwiYmZyRXhwIiwiZmxpZ2h0UmV2aWV3RXhwaXJhdGlvbiIsImNoZWNrV2VhdGhlclZzUGlsb3QiLCJmbGlnaHRDYXRlZ29yeSIsIndpbmQiLCJjaGVja3MiLCJjZXJ0aWZpY2F0ZXMiLCJpbnN0cnVtZW50UmF0ZWQiLCJwdXNoIiwibmFtZSIsImV4cGVyaWVuY2UiLCJ0b3RhbEhvdXJzIiwibWF4V2luZCIsIm1heCIsInNwZWVkIiwiZ3VzdCIsImNhbGN1bGF0ZU92ZXJhbGxTdGF0dXMiLCJzb21lIiwiYyIsImdlbmVyYXRlU3VtbWFyeSIsIm92ZXJhbGxTdGF0dXMiLCJmYWlsZWRDaGVja3MiLCJmaWx0ZXIiLCJ3YXJuaW5ncyIsInN1bW1hcnkiLCJsZW5ndGgiLCJmb3JFYWNoIiwicnVuTGVnYWxpdHlBdWRpdCIsImZsaWdodElkIiwiZmxpZ2h0IiwiZmluZEJ5SWQiLCJwb3B1bGF0ZSIsImV4ZWMiLCJFcnJvciIsInNjaGVkdWxlZERhdGUiLCJ3ZWF0aGVyIiwiZmV0Y2hlZFdlYXRoZXIiLCJkZXBhcnR1cmVBaXJwb3J0IiwiY29uc29sZSIsIndhcm4iLCJ3ZWF0aGVyQ2hlY2tzIiwicmlza1NjZW5hcmlvcyIsImNhbGN1bGF0ZVJpc2tTY2VuYXJpb3MiLCJsZWdhbGl0eUNoZWNrcyIsInNhZmV0eUFuYWx5c2lzU25hcHNob3QiLCJnZW5lcmF0ZWRBdCIsInNhdmUiLCJzY2VuYXJpb3MiLCJob3VyIiwiZ2V0SG91cnMiLCJpc05pZ2h0RmxpZ2h0IiwiYWlyZnJhbWVIb3VycyIsImhvYmJzIiwiYWx0ZXJuYXRvclJpc2siLCJtaW4iLCJyb3VuZCIsImFsdGVybmF0b3JTZXZlcml0eSIsIm5pZ2h0SG91cnMiLCJ0aXRsZSIsInByb2JhYmlsaXR5Iiwic2V2ZXJpdHkiLCJ3eFJpc2siLCJpc0lSUGlsb3QiLCJ3eFNldmVyaXR5IiwiY2VpbGluZyIsInZpc2liaWxpdHkiLCJpc1N0dWRlbnQiLCJ0eXBlIiwibGFzdDkwRGF5cyIsImxhc3Q5MERheXNIb3VycyIsInNhZmV0eUFuYWx5c2lzIiwic2NvcmUiLCJhaVNjb3JlIiwiZXhwUmlzayIsImV4cFNldmVyaXR5IiwiZW5naW5lSG91cnMiLCJlbmdpbmVSaXNrIiwic29ydCIsImEiLCJiIiwic2V2ZXJpdHlPcmRlciIsImNyaXRpY2FsIiwiaGlnaCIsIm1lZGl1bSIsImxvdyIsInJ1bk9mZmxpbmVBdWRpdCIsInN0YXRpb24iLCJtZXRhciIsImZldGNoZWRBdCIsInVuZGVmaW5lZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/services/legalityService.ts\n");

/***/ }),

/***/ "(rsc)/./lib/services/weatherService.ts":
/*!****************************************!*\
  !*** ./lib/services/weatherService.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fetchTAFData: () => (/* binding */ fetchTAFData),\n/* harmony export */   fetchWeatherData: () => (/* binding */ fetchWeatherData)\n/* harmony export */ });\n// Weather service using aviationweather.gov (ADDS) API\n// This is a simplified implementation - production would use Firecrawl for more sophisticated scraping\nasync function fetchWeatherData(airportCode) {\n    try {\n        // ADDS Text Data Server URL for METAR data\n        const station = airportCode.toUpperCase().replace(/^K/, \"\");\n        const stationCode = airportCode.length === 3 ? `K${station}` : station;\n        // In production, this would use Firecrawl to scrape aviation weather\n        // For now, we'll use the ADDS API directly\n        const url = `https://aviationweather.gov/api/data/metar?ids=${stationCode}&format=json&hours=1`;\n        const response = await fetch(url);\n        if (!response.ok) {\n            console.error(\"Weather API error:\", response.status);\n            return null;\n        }\n        const data = await response.json();\n        if (!data || data.length === 0) {\n            return null;\n        }\n        const metar = data[0];\n        // Parse flight category\n        const flightCategory = determineFlightCategory(metar.visib, metar.clouds);\n        // Parse wind data\n        const wind = {\n            direction: metar.wdir || 0,\n            speed: metar.wspd || 0,\n            gust: metar.wgst || undefined\n        };\n        // Find ceiling\n        const ceiling = findCeiling(metar.clouds);\n        return {\n            station: stationCode,\n            metar: metar.rawOb || \"\",\n            flightCategory,\n            visibility: metar.visib || 10,\n            ceiling,\n            wind,\n            fetchedAt: new Date()\n        };\n    } catch (error) {\n        console.error(\"Error fetching weather:\", error);\n        return null;\n    }\n}\nfunction determineFlightCategory(visibility, clouds) {\n    const vis = visibility ?? 10;\n    const ceiling = findCeiling(clouds);\n    // LIFR: Ceiling < 500 feet and/or visibility < 1 mile\n    if (ceiling !== undefined && ceiling < 500) return \"LIFR\";\n    if (vis < 1) return \"LIFR\";\n    // IFR: Ceiling 500-1000 feet and/or visibility 1-3 miles\n    if (ceiling !== undefined && ceiling < 1000) return \"IFR\";\n    if (vis < 3) return \"IFR\";\n    // MVFR: Ceiling 1000-3000 feet and/or visibility 3-5 miles\n    if (ceiling !== undefined && ceiling < 3000) return \"MVFR\";\n    if (vis < 5) return \"MVFR\";\n    // VFR: Ceiling > 3000 feet and visibility > 5 miles\n    return \"VFR\";\n}\nfunction findCeiling(clouds) {\n    if (!clouds || clouds.length === 0) return undefined;\n    // Ceiling is the lowest BKN (broken) or OVC (overcast) layer\n    for (const layer of clouds){\n        if (layer.cover === \"BKN\" || layer.cover === \"OVC\") {\n            return layer.base;\n        }\n    }\n    return undefined;\n}\n// Function to fetch TAF (Terminal Aerodrome Forecast)\nasync function fetchTAFData(airportCode) {\n    try {\n        const station = airportCode.toUpperCase().replace(/^K/, \"\");\n        const stationCode = airportCode.length === 3 ? `K${station}` : station;\n        const url = `https://aviationweather.gov/api/data/taf?ids=${stationCode}&format=json`;\n        const response = await fetch(url);\n        if (!response.ok) {\n            return null;\n        }\n        const data = await response.json();\n        if (!data || data.length === 0) {\n            return null;\n        }\n        return data[0].rawTAF || null;\n    } catch (error) {\n        console.error(\"Error fetching TAF:\", error);\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUVGLFlBQVksWUFBWSxDQUFDO1FBRXJGLE1BQU1HLFdBQVcsTUFBTUMsTUFBTUY7UUFFN0IsSUFBSSxDQUFDQyxTQUFTRSxFQUFFLEVBQUU7WUFDaEIsT0FBTztRQUNUO1FBRUEsTUFBTUksT0FBTyxNQUFNTixTQUFTTyxJQUFJO1FBRWhDLElBQUksQ0FBQ0QsUUFBUUEsS0FBS1IsTUFBTSxLQUFLLEdBQUc7WUFDOUIsT0FBTztRQUNUO1FBRUEsT0FBT1EsSUFBSSxDQUFDLEVBQUUsQ0FBQzBCLE1BQU0sSUFBSTtJQUMzQixFQUFFLE9BQU81QixPQUFPO1FBQ2RELFFBQVFDLEtBQUssQ0FBQyx1QkFBdUJBO1FBQ3JDLE9BQU87SUFDVDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXZpYXRpb24taW50ZWxsaWdlbmNlLWJyYWluLy4vbGliL3NlcnZpY2VzL3dlYXRoZXJTZXJ2aWNlLnRzP2M4YzciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSVdlYXRoZXJEYXRhIH0gZnJvbSAnLi4vbW9kZWxzL0ZsaWdodCc7XG5cbi8vIFdlYXRoZXIgc2VydmljZSB1c2luZyBhdmlhdGlvbndlYXRoZXIuZ292IChBRERTKSBBUElcbi8vIFRoaXMgaXMgYSBzaW1wbGlmaWVkIGltcGxlbWVudGF0aW9uIC0gcHJvZHVjdGlvbiB3b3VsZCB1c2UgRmlyZWNyYXdsIGZvciBtb3JlIHNvcGhpc3RpY2F0ZWQgc2NyYXBpbmdcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoV2VhdGhlckRhdGEoYWlycG9ydENvZGU6IHN0cmluZyk6IFByb21pc2U8SVdlYXRoZXJEYXRhIHwgbnVsbD4ge1xuICB0cnkge1xuICAgIC8vIEFERFMgVGV4dCBEYXRhIFNlcnZlciBVUkwgZm9yIE1FVEFSIGRhdGFcbiAgICBjb25zdCBzdGF0aW9uID0gYWlycG9ydENvZGUudG9VcHBlckNhc2UoKS5yZXBsYWNlKC9eSy8sICcnKTtcbiAgICBjb25zdCBzdGF0aW9uQ29kZSA9IGFpcnBvcnRDb2RlLmxlbmd0aCA9PT0gMyA/IGBLJHtzdGF0aW9ufWAgOiBzdGF0aW9uO1xuXG4gICAgLy8gSW4gcHJvZHVjdGlvbiwgdGhpcyB3b3VsZCB1c2UgRmlyZWNyYXdsIHRvIHNjcmFwZSBhdmlhdGlvbiB3ZWF0aGVyXG4gICAgLy8gRm9yIG5vdywgd2UnbGwgdXNlIHRoZSBBRERTIEFQSSBkaXJlY3RseVxuICAgIGNvbnN0IHVybCA9IGBodHRwczovL2F2aWF0aW9ud2VhdGhlci5nb3YvYXBpL2RhdGEvbWV0YXI/aWRzPSR7c3RhdGlvbkNvZGV9JmZvcm1hdD1qc29uJmhvdXJzPTFgO1xuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpO1xuXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgY29uc29sZS5lcnJvcignV2VhdGhlciBBUEkgZXJyb3I6JywgcmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICBpZiAoIWRhdGEgfHwgZGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IG1ldGFyID0gZGF0YVswXTtcblxuICAgIC8vIFBhcnNlIGZsaWdodCBjYXRlZ29yeVxuICAgIGNvbnN0IGZsaWdodENhdGVnb3J5ID0gZGV0ZXJtaW5lRmxpZ2h0Q2F0ZWdvcnkobWV0YXIudmlzaWIsIG1ldGFyLmNsb3Vkcyk7XG5cbiAgICAvLyBQYXJzZSB3aW5kIGRhdGFcbiAgICBjb25zdCB3aW5kID0ge1xuICAgICAgZGlyZWN0aW9uOiBtZXRhci53ZGlyIHx8IDAsXG4gICAgICBzcGVlZDogbWV0YXIud3NwZCB8fCAwLFxuICAgICAgZ3VzdDogbWV0YXIud2dzdCB8fCB1bmRlZmluZWQsXG4gICAgfTtcblxuICAgIC8vIEZpbmQgY2VpbGluZ1xuICAgIGNvbnN0IGNlaWxpbmcgPSBmaW5kQ2VpbGluZyhtZXRhci5jbG91ZHMpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN0YXRpb246IHN0YXRpb25Db2RlLFxuICAgICAgbWV0YXI6IG1ldGFyLnJhd09iIHx8ICcnLFxuICAgICAgZmxpZ2h0Q2F0ZWdvcnksXG4gICAgICB2aXNpYmlsaXR5OiBtZXRhci52aXNpYiB8fCAxMCxcbiAgICAgIGNlaWxpbmcsXG4gICAgICB3aW5kLFxuICAgICAgZmV0Y2hlZEF0OiBuZXcgRGF0ZSgpLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgd2VhdGhlcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuZnVuY3Rpb24gZGV0ZXJtaW5lRmxpZ2h0Q2F0ZWdvcnkoXG4gIHZpc2liaWxpdHk6IG51bWJlciB8IHVuZGVmaW5lZCxcbiAgY2xvdWRzOiBBcnJheTx7IGNvdmVyOiBzdHJpbmc7IGJhc2U6IG51bWJlciB9PiB8IHVuZGVmaW5lZFxuKTogJ1ZGUicgfCAnTVZGUicgfCAnSUZSJyB8ICdMSUZSJyB7XG4gIGNvbnN0IHZpcyA9IHZpc2liaWxpdHkgPz8gMTA7XG4gIGNvbnN0IGNlaWxpbmcgPSBmaW5kQ2VpbGluZyhjbG91ZHMpO1xuXG4gIC8vIExJRlI6IENlaWxpbmcgPCA1MDAgZmVldCBhbmQvb3IgdmlzaWJpbGl0eSA8IDEgbWlsZVxuICBpZiAoY2VpbGluZyAhPT0gdW5kZWZpbmVkICYmIGNlaWxpbmcgPCA1MDApIHJldHVybiAnTElGUic7XG4gIGlmICh2aXMgPCAxKSByZXR1cm4gJ0xJRlInO1xuXG4gIC8vIElGUjogQ2VpbGluZyA1MDAtMTAwMCBmZWV0IGFuZC9vciB2aXNpYmlsaXR5IDEtMyBtaWxlc1xuICBpZiAoY2VpbGluZyAhPT0gdW5kZWZpbmVkICYmIGNlaWxpbmcgPCAxMDAwKSByZXR1cm4gJ0lGUic7XG4gIGlmICh2aXMgPCAzKSByZXR1cm4gJ0lGUic7XG5cbiAgLy8gTVZGUjogQ2VpbGluZyAxMDAwLTMwMDAgZmVldCBhbmQvb3IgdmlzaWJpbGl0eSAzLTUgbWlsZXNcbiAgaWYgKGNlaWxpbmcgIT09IHVuZGVmaW5lZCAmJiBjZWlsaW5nIDwgMzAwMCkgcmV0dXJuICdNVkZSJztcbiAgaWYgKHZpcyA8IDUpIHJldHVybiAnTVZGUic7XG5cbiAgLy8gVkZSOiBDZWlsaW5nID4gMzAwMCBmZWV0IGFuZCB2aXNpYmlsaXR5ID4gNSBtaWxlc1xuICByZXR1cm4gJ1ZGUic7XG59XG5cbmZ1bmN0aW9uIGZpbmRDZWlsaW5nKFxuICBjbG91ZHM6IEFycmF5PHsgY292ZXI6IHN0cmluZzsgYmFzZTogbnVtYmVyIH0+IHwgdW5kZWZpbmVkXG4pOiBudW1iZXIgfCB1bmRlZmluZWQge1xuICBpZiAoIWNsb3VkcyB8fCBjbG91ZHMubGVuZ3RoID09PSAwKSByZXR1cm4gdW5kZWZpbmVkO1xuXG4gIC8vIENlaWxpbmcgaXMgdGhlIGxvd2VzdCBCS04gKGJyb2tlbikgb3IgT1ZDIChvdmVyY2FzdCkgbGF5ZXJcbiAgZm9yIChjb25zdCBsYXllciBvZiBjbG91ZHMpIHtcbiAgICBpZiAobGF5ZXIuY292ZXIgPT09ICdCS04nIHx8IGxheWVyLmNvdmVyID09PSAnT1ZDJykge1xuICAgICAgcmV0dXJuIGxheWVyLmJhc2U7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxuLy8gRnVuY3Rpb24gdG8gZmV0Y2ggVEFGIChUZXJtaW5hbCBBZXJvZHJvbWUgRm9yZWNhc3QpXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hUQUZEYXRhKGFpcnBvcnRDb2RlOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBzdGF0aW9uID0gYWlycG9ydENvZGUudG9VcHBlckNhc2UoKS5yZXBsYWNlKC9eSy8sICcnKTtcbiAgICBjb25zdCBzdGF0aW9uQ29kZSA9IGFpcnBvcnRDb2RlLmxlbmd0aCA9PT0gMyA/IGBLJHtzdGF0aW9ufWAgOiBzdGF0aW9uO1xuXG4gICAgY29uc3QgdXJsID0gYGh0dHBzOi8vYXZpYXRpb253ZWF0aGVyLmdvdi9hcGkvZGF0YS90YWY/aWRzPSR7c3RhdGlvbkNvZGV9JmZvcm1hdD1qc29uYDtcblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsKTtcblxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICBpZiAoIWRhdGEgfHwgZGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiBkYXRhWzBdLnJhd1RBRiB8fCBudWxsO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIFRBRjonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJmZXRjaFdlYXRoZXJEYXRhIiwiYWlycG9ydENvZGUiLCJzdGF0aW9uIiwidG9VcHBlckNhc2UiLCJyZXBsYWNlIiwic3RhdGlvbkNvZGUiLCJsZW5ndGgiLCJ1cmwiLCJyZXNwb25zZSIsImZldGNoIiwib2siLCJjb25zb2xlIiwiZXJyb3IiLCJzdGF0dXMiLCJkYXRhIiwianNvbiIsIm1ldGFyIiwiZmxpZ2h0Q2F0ZWdvcnkiLCJkZXRlcm1pbmVGbGlnaHRDYXRlZ29yeSIsInZpc2liIiwiY2xvdWRzIiwid2luZCIsImRpcmVjdGlvbiIsIndkaXIiLCJzcGVlZCIsIndzcGQiLCJndXN0Iiwid2dzdCIsInVuZGVmaW5lZCIsImNlaWxpbmciLCJmaW5kQ2VpbGluZyIsInJhd09iIiwidmlzaWJpbGl0eSIsImZldGNoZWRBdCIsIkRhdGUiLCJ2aXMiLCJsYXllciIsImNvdmVyIiwiYmFzZSIsImZldGNoVEFGRGF0YSIsInJhd1RBRiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/services/weatherService.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/resend"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Faudit%2F%5BflightId%5D%2Froute&page=%2Fapi%2Faudit%2F%5BflightId%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Faudit%2F%5BflightId%5D%2Froute.ts&appDir=%2FUsers%2Fahmed%2FDocuments%2FGitHub%2FLogHacker%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fahmed%2FDocuments%2FGitHub%2FLogHacker&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();